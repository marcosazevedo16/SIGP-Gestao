<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    <title>SIGP Gest√£o - Setor de Sa√∫de</title>
  
    <meta http-equiv="Content-Security-Policy" 
    content="default-src 'self' 'unsafe-inline' https: data: blob:; 
             style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
             font-src 'self' https://fonts.gstatic.com https://r2cdn.perplexity.ai data:; 
             script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://www.gstatic.com; 
             connect-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://*.googleapis.com https://*.firebaseio.com https://www.gstatic.com;
             frame-src 'self' blob: data:;">
             
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>  
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        window.jsPDF = window.jspdf.jsPDF;
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23005580%22/><text x=%2250%22 y=%2235%22 font-family=%22Arial, sans-serif%22 font-weight=%22bold%22 font-size=%2228%22 text-anchor=%22middle%22 fill=%22white%22>SIGP</text><rect x=%2222%22 y=%2258%22 width=%2212%22 height=%2216%22 fill=%22%234ECDC4%22/><rect x=%2244%22 y=%2246%22 width=%2212%22 height=%2228%22 fill=%22%234ECDC4%22/><rect x=%2266%22 y=%2252%22 width=%2212%22 height=%2222%22 fill=%22%234ECDC4%22/><text x=%2250%22 y=%2292%22 font-family=%22Arial, sans-serif%22 font-size=%2217%22 font-weight=%22bold%22 text-anchor=%22middle%22 fill=%22white%22>Gest√£o</text></svg>">
    <body class="loading">
    
    <div id="offline-banner" class="offline-banner">
    üì° Voc√™ est√° sem internet. O sistema continua funcionando, mas downloads (PDF/Backup) podem falhar.
</div>

    <!-- Login Screen -->
   <div id="login-screen" class="login-screen">
        <div class="login-wrapper">
            <div class="login-left">
                <div class="login-branding">
                    <h1 class="login-title">SIGP Gest√£o</h1>
                    <p class="login-tagline">Setor de Sa√∫de da empresa<br>HLH¬Æ Servi√ßos & Tecnologia</p>
                </div>
            </div>
            <div class="login-right">
                <div class="login-form-container">
                    <h2 class="login-form-title">Acesso ao Sistema</h2>
                    <p class="login-form-subtitle">Digite login e Senha para continuar</p>
                    
                    <form id="login-form">
                        <div class="form-group">
                            <label class="form-label">Login</label>
                            <input type="text" class="form-control" id="login-username" required placeholder="DIGITE SEU LOGIN" autocomplete="username">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Senha</label>
                            <input type="password" class="form-control" id="login-password" required placeholder="Digite sua senha" autocomplete="current-password">
                            
                            <div style="text-align: right; margin-top: 8px;">
                                <a href="#" onclick="showForgotPasswordModal(event)" class="forgot-password-link">Esqueci minha senha</a>
                            </div>
                        </div> 
                        
                        <div id="login-error" class="login-error"></div>
                        <button type="submit" class="btn btn--primary btn--full-width login-btn">Entrar no Sistema</button>
                    </form>
                </div>
            </div>
            
            <div class="login-waves">
                <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
                    <path d="M0,0 C150,80 350,0 600,40 C850,80 1050,20 1200,60 L1200,120 L0,120 Z" fill="rgba(255,255,255,0.1)"/>
                </svg>
            </div>
            <div class="login-waves login-waves-2">
                <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
                    <path d="M0,0 C200,60 400,0 600,30 C800,60 1000,0 1200,40 L1200,120 L0,120 Z" fill="rgba(255,255,255,0.05)"/>
                </svg>
            </div>
        </div>
    </div>
    <!-- Main App (hidden until login) -->

    <div id="main-app" class="main-app">

           <header class="app-header">

    <div class="header-content"> 

<button class="btn btn--outline btn--sm mobile-menu-toggle" onclick="toggleMobileMenu()">

            ‚ò∞ Menu

        </button>

<div>
                <h1>SIGP Sa√∫de - Gest√£o de Setor</h1>

                <p class="subtitle">Sistema de Gest√£o Completo</p>

            </div>

            <div class="header-user-info">
                <span class="user-welcome">Seja bem-vindo(a), <strong id="logged-user-name">Usu√°rio</strong></span>

            </div>

           <div class="header-actions">
                <button class="btn btn--outline btn--sm header-icon-btn" id="home-btn" onclick="navigateToHome()" title="Tela Inicial">
                    üè†
                </button>
                
                <button class="btn btn--outline btn--sm header-icon-btn" id="theme-toggle" onclick="toggleTheme()" title="Alternar Tema">
                    üåô
                </button>
                
                <div class="settings-dropdown">
                    <button class="btn btn--outline btn--sm relative header-icon-btn" id="notif-btn" onclick="toggleNotifications()" title="Notifica√ß√µes">
                        üîî <span id="notif-badge" class="notification-badge" style="display:none;">0</span>
                    </button>
                    <div class="settings-menu notification-menu" id="notification-menu">
                        <div class="notification-header">Notifica√ß√µes</div>
                        <div id="notification-list" class="notification-list">
                            <p style="padding:10px; color:#666;">Nenhuma notifica√ß√£o.</p>
                        </div>
                    </div>
                </div>

                <div class="settings-dropdown" id="settings-dropdown-container">
                    <button class="btn btn--outline btn--sm header-text-btn" onclick="toggleSettings()" title="Configura√ß√µes">
                        ‚öôÔ∏è Configura√ß√µes
                    </button>
                    
                    <div class="settings-menu" id="settings-menu">
                        <button class="settings-menu-item" id="user-management-menu-btn" style="display: none;" onclick="navigateToUserManagement()">
                            üë• Gest√£o de Usu√°rios
                        </button>
                        <button class="settings-menu-item" onclick="showChangePasswordModal(); toggleSettings();">
                            üîí Alterar Senha
                        </button>
                        <div class="settings-divider" id="admin-divider" style="display: none;"></div>

                        <button class="settings-menu-item" id="cargo-management-menu-btn" onclick="navigateToCargoManagement()">
                            üíº Cadastro de Cargo/Fun√ß√£o
                        </button>
                        <button class="settings-menu-item" id="orientador-management-menu-btn" onclick="navigateToOrientadorManagement()">
                            üë®‚Äçüè´ Cadastro de Colaborador
                        </button>
                        <button class="settings-menu-item" id="modulo-management-menu-btn" onclick="navigateToModuloManagement()">
                            üì¶ Cadastro de M√≥dulos
                        </button>
                        <button class="settings-menu-item" id="municipality-list-management-menu-btn" onclick="navigateToMunicipalityListManagement()">
                            üèôÔ∏è Cadastro de Munic√≠pios
                        </button>
                        <button class="settings-menu-item" id="forma-apresentacao-management-menu-btn" onclick="navigateToFormaApresentacaoManagement()">
                            üìã Formas de Apresenta√ß√£o
                        </button>
                        <button class="settings-menu-item" id="api-list-management-menu-btn" onclick="navigateToApiListManagement()">
                            üåê Cadastro de APIs
                        </button>

                        <div class="settings-divider"></div>

                        <button class="settings-menu-item" id="backup-menu-btn" onclick="navigateToBackupManagement()">
                            üíæ Backup e Restaura√ß√£o
                        </button>
                        <button class="settings-menu-item" id="audit-menu-btn" onclick="navigateToAudit()">
                            üïµÔ∏è Auditoria (Logs)
                        </button>
                    </div>
                </div>

                <button class="btn btn--secondary btn--sm header-text-btn" onclick="handleLogout()" title="Sair do Sistema">
                  üö™ Sair
                </button>
            </div>

    </header>

    <div class="app-layout">
        <div class="sidebar-overlay" onclick="toggleMobileMenu()"></div>
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <button class="sidebar-btn active" data-tab="dashboard">
                    <span class="sidebar-icon">üìä</span>

                    <span>Dashboard</span>

                </button>

                <button class="sidebar-btn" data-tab="municipios">

                    <span class="sidebar-icon">üèõ</span>

                    <span>Munic√≠pios Clientes</span>

                </button>

                <button class="sidebar-btn" data-tab="tarefas">

                    <span class="sidebar-icon">‚úì</span>

                    <span>Controle de Treinamentos</span>

                </button>

                <button class="sidebar-btn" data-tab="solicitacoes">

                    <span class="sidebar-icon">üí¨</span>

                    <span>Solicita√ß√µes/Sugest√µes de Clientes</span>

                </button>

                <button class="sidebar-btn" data-tab="apresentacoes">

                    <span class="sidebar-icon">üìä</span>

                    <span>Apresenta√ß√µes do Software</span>

                </button>

                <button class="sidebar-btn" data-tab="demandas">

                    <span class="sidebar-icon">üìû</span>

                    <span>Demandas do Suporte</span>

                </button>

                <button class="sidebar-btn" data-tab="visitas">

                    <span class="sidebar-icon">üöó</span>

                    <span>Solicita√ß√µes de Visitas Presenciais</span>

                </button>

                <button class="sidebar-btn" data-tab="producao">

                    <span class="sidebar-icon">üì¶</span>

                    <span>Controle de Envio de Produ√ß√£o</span>

                </button>
                <button class="sidebar-btn" data-tab="apis">
    <span class="sidebar-icon">üåê</span>
    <span>APIs de Integra√ß√£o</span>
</button>

<button class="sidebar-btn" data-tab="info-colaboradores">
    <span class="sidebar-icon">ü™™</span>
    <span>Informa√ß√µes de Colaboradores</span>
</button>

                <button class="sidebar-btn" data-tab="relatorios">

                    <span class="sidebar-icon">üìà</span>

                    <span>Relat√≥rios de Gest√£o</span>

                </button>

            </nav>

        </aside>

    <main class="main-content">

        <section id="versoes-section" class="tab-content">

    <div class="section-header">

        <h2>Hist√≥rico de Vers√µes</h2>

        <button class="btn btn--primary" onclick="showVersionModal()">+ Nova Vers√£o</button>

    </div>

    <div class="tasks-table" id="versions-table"></div>

</section>

        <!-- Aba Dashboard -->

      <section id="dashboard-section" class="tab-content active">

            <div class="section-header">
                <h2>Dashboard - Painel de Controle</h2>
            </div>

            <div class="section-divider" style="margin-top: 0;"></div>
            
            <h3 style="text-align: center; text-transform: uppercase; color: var(--color-primary); margin-bottom: 20px;">1. Hist√≥rico e Totais</h3>

            <div class="stats-cards" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); margin-bottom: 24px;">
                <div class="stat-card">
                    <h3 id="dashboard-municipalities-in-use">0</h3>
                    <p>Munic√≠pios Utilizando SIGP Sa√∫de</p>
                </div>
                <div class="stat-card">
                    <h3 id="dashboard-trainings-completed">0</h3>
                    <p>Treinamentos Realizados</p>
                </div>
                <div class="stat-card">
                    <h3 id="dashboard-requests-completed">0</h3>
                    <p>Solicita√ß√µes de Clientes Atendidas</p>
                </div>
                <div class="stat-card">
                    <h3 id="dashboard-presentations-completed">0</h3>
                    <p>Apresenta√ß√µes de Sistema Realizadas</p>
                </div>
            </div>

            <div class="chart-card" style="margin-bottom: 24px;">
                <h4>Evolu√ß√£o de Implanta√ß√µes por Ano</h4>
                <div style="height: 300px;">
                    <canvas id="chartEvolution"></canvas>
                </div>
            </div>

            <div class="chart-card" style="margin-bottom: 40px;">
                <h4>Implanta√ß√µes ao Longo do Tempo (Acumulado)</h4>
                <div style="height: 300px;">
                    <canvas id="timelineChart"></canvas>
                </div>
            </div>

            <div class="section-divider"></div>

            <h3 style="text-align: center; text-transform: uppercase; color: var(--color-primary); margin-bottom: 20px;">2. Performance de Equipe</h3>

            <div class="charts-grid">
                <div class="chart-card">
                    <h4>Produtividade Operacional (√öltimos 12 Meses)</h4>
                    <div style="height: 300px;">
                        <canvas id="chartProductivity"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h4>Treinamentos por Colaborador (√öltimos 12 Meses)</h4>
                    <div style="height: 300px;">
                        <canvas id="chartTrainingByColab"></canvas>
                    </div>
                </div>
            </div>

            <div class="section-divider"></div>

            <h3 style="text-align: center; text-transform: uppercase; color: var(--color-primary); margin-bottom: 20px;">3. Dados Operacionais</h3>

            <div class="charts-grid">
                <div class="chart-card">
                    <h4>Sa√∫de da Carteira de Clientes</h4>
                    <div style="height: 300px;">
                        <canvas id="chartMunicipalityStatus"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <h4>Demandas Cadastradas por Usu√°rio</h4>
                    <div style="height: 300px;">
                        <canvas id="chartDemandsByUser"></canvas>
                    </div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h4>Utiliza√ß√£o de M√≥dulos (Ranking Completo)</h4>
                    <div style="height: 400px;">
                        <canvas id="chartTopModules"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <h4>Gargalos de Suporte</h4>
                    <div style="height: 400px;">
                        <canvas id="chartSupportBacklog"></canvas>
                    </div>
                </div>
            </div>

        </section>

        <!-- Aba Demandas do Suporte -->

       <section id="demandas-section" class="tab-content">
            <div class="section-header">
                <h2>Demandas do Suporte</h2>
                <button class="btn btn--primary" onclick="showDemandModal()">+ Nova Demanda</button>
            </div>

            <h3 class="section-subtitle">Filtros</h3>
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-demand-status">
                            <option value="">Todos</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Realizada">Realizada</option>
                            <option value="Invi√°vel">Invi√°vel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Prioridade</label>
                        <select class="form-control" id="filter-demand-priority">
                            <option value="">Todas</option>
                            <option value="Alta">Alta</option>
                            <option value="M√©dia">M√©dia</option>
                            <option value="Baixa">Baixa</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Usu√°rio da Demanda</label>
                        <select class="form-control" id="filter-demand-user">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
    <label class="form-label">Solicita√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-demand-sol-start" onchange="validateDateRange('dem-sol')">
</div>
<div class="form-group">
    <label class="form-label">Solicita√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-demand-sol-end" onchange="validateDateRange('dem-sol')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-demand-real-start" onchange="validateDateRange('dem-real')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-demand-real-end" onchange="validateDateRange('dem-real')">
</div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearDemandFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div id="demands-results-count" class="results-count" style="display: none;"></div>

           <div class="tasks-table" id="demands-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="demandasRowsPerPage" onchange="mudarQtdPorPaginaDemandas(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="demandasPagination">
                    </div>
            </div>
            <div class="actions-bar">
                <button class="btn btn--outline btn--sm" onclick="exportDemandsCSV()">üì• Exportar CSV</button>
                <button class="btn btn--primary btn--sm" onclick="generateDemandsPDF()">üìÑ Gerar PDF</button>
            </div>

            <div class="section-divider"></div>

            <h3 class="section-subtitle">Gr√°ficos e Estat√≠sticas</h3>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-demands">0</h3>
                    <p>Total de Demandas</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-demands">0</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-demands">0</h3>
                    <p>Realizadas</p>
                </div>
                <div class="stat-card">
                    <h3 id="unfeasible-demands">0</h3>
                    <p>Invi√°veis</p>
                </div>
            </div>

            <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="demandStatusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4>Demandas por Prioridade</h4>
                        <canvas id="demandPriorityChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4>Demandas por Usu√°rio</h4>
                        <canvas id="demandUserChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Aba Solicita√ß√µes de Visitas Presenciais -->

        <section id="visitas-section" class="tab-content">
            <div class="section-header">
                <h2>Solicita√ß√µes de Visitas Presenciais</h2>
                <button class="btn btn--primary" onclick="showVisitModal()">+ Nova Solicita√ß√£o de Visita</button>
            </div>

            <h3 class="section-subtitle">Filtros</h3>
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Munic√≠pio</label>
                        <select class="form-control" id="filter-visit-municipality">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-visit-status">
                            <option value="">Todos</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Realizada">Realizada</option>
                            <option value="Cancelada">Cancelada</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Solicitante</label>
                        <input type="text" class="form-control" id="filter-visit-applicant" placeholder="Buscar solicitante">
                    </div>
                    
                    <div class="form-group"></div> 

                    <div class="form-group">
    <label class="form-label">Solicita√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-visit-sol-start" onchange="validateDateRange('visit-sol')">
</div>
<div class="form-group">
    <label class="form-label">Solicita√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-visit-sol-end" onchange="validateDateRange('visit-sol')">
</div>
<div class="form-group">
    <label class="form-label">Data Visita (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-visit-real-start" onchange="validateDateRange('visit-real')">
</div>
<div class="form-group">
    <label class="form-label">Data Visita (Fim)</label>
    <input type="date" class="form-control" id="filter-visit-real-end" onchange="validateDateRange('visit-real')">
</div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearVisitFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div id="visits-results-count" class="results-count" style="display: none;"></div>

          <div class="tasks-table" id="visits-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="visitasRowsPerPage" onchange="mudarQtdPorPaginaVisitas(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="visitasPagination">
                    </div>
            </div>
            <div class="section-divider"></div>

            <h3 class="section-subtitle">Gr√°ficos e Estat√≠sticas</h3>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-visits">0</h3>
                    <p>Total de Visitas</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-visits">0</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-visits">0</h3>
                    <p>Realizadas</p>
                </div>
                <div class="stat-card">
                    <h3 id="cancelled-visits">0</h3>
                    <p>Canceladas</p>
                </div>
            </div>

            <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="visitStatusChart"></canvas>
                    </div>
                    <div class="chart-card chart-card--wide">
                        <h4>Visitas por Munic√≠pio</h4>
                        <canvas id="visitMunicipalityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Aba Controle de Envio de Produ√ß√£o -->

        <section id="producao-section" class="tab-content">
            <div class="section-header">
                <h2>Controle de Envio de Produ√ß√£o</h2>
                <button class="btn btn--primary" onclick="showProductionModal()">+ Novo Envio</button>
            </div>

            <h3 class="section-subtitle">Filtros</h3>
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Munic√≠pio</label>
                        <select class="form-control" id="filter-production-municipality">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-production-status">
                            <option value="">Todos</option>
                            <option value="Enviada">Enviada</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Cancelada">Cancelada</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Profissional</label>
                        <input type="text" class="form-control" id="filter-production-professional" placeholder="Buscar por profissional">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Frequ√™ncia</label>
                        <select class="form-control" id="filter-production-frequency">
                            <option value="">Todas</option>
                            <option value="Di√°rio">Di√°rio</option>
                            <option value="Semanal">Semanal</option>
                            <option value="Quinzenal">Quinzenal</option>
                            <option value="Mensal">Mensal</option>
                        </select>
                    </div>
                    <div class="form-group">
    <label class="form-label">Data Libera√ß√£o Inicial</label>
    <input type="date" class="form-control" id="filter-production-release-start" onchange="validateDateRange('prod-rel')">
</div>
<div class="form-group">
    <label class="form-label">Data Libera√ß√£o Final</label>
    <input type="date" class="form-control" id="filter-production-release-end" onchange="validateDateRange('prod-rel')">
</div>
<div class="form-group">
    <label class="form-label">Data Envio Inicial</label>
    <input type="date" class="form-control" id="filter-production-send-start" onchange="validateDateRange('prod-send')">
</div>
<div class="form-group">
    <label class="form-label">Data Envio Final</label>
    <input type="date" class="form-control" id="filter-production-send-end" onchange="validateDateRange('prod-send')">
</div>
                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearProductionFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div class="tasks-table" id="productions-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="producaoRowsPerPage" onchange="mudarQtdPorPaginaProducao(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="producaoPagination">
                    </div>
            </div>
            <div class="section-divider"></div>

            <h3 class="section-subtitle">Gr√°ficos e Estat√≠sticas</h3>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-productions">0</h3>
                    <p>Total de Envios</p>
                </div>
                <div class="stat-card">
                    <h3 id="sent-productions">0</h3>
                    <p>Enviadas</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-productions">0</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="cancelled-productions">0</h3>
                    <p>Canceladas</p>
                </div>
            </div>

            <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="productionStatusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4>Envios por Frequ√™ncia</h4>
                        <canvas id="productionFrequencyChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Aba Relat√≥rios de Gest√£o -->

        <section id="relatorios-section" class="tab-content">
    <div class="section-header">
        <h2>Relat√≥rios de Gest√£o</h2>
    </div>

    <div class="report-generator-container">
        <div class="report-config-box">
    <h3>Filtros de Relat√≥rio</h3>
    
    <div style="display: flex; flex-direction: column; gap: 20px;">
        
        <div class="form-group" style="margin-bottom:0;">
            <label class="form-label">Selecione o Relat√≥rio</label>
            <select class="form-control" id="filter-report-type" onchange="updateReportFiltersUI()">
                <option value="">Selecione...</option>
                <option value="municipios">Carteira de Clientes</option>
                <option value="treinamentos">Treinamentos</option>
                <option value="apresentacoes">Apresenta√ß√µes</option>
                <option value="visitas">Visitas Presenciais</option>
                <option value="producao">Controle de Produ√ß√£o</option>
                <option value="integracoes">Integra√ß√µes e APIs</option>
                <option value="colaboradores">Colaboradores (RH)</option>
            </select>
        </div>

        <div id="filters-municipios" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <div class="form-group">
                <label class="form-label">Considerar Data de:</label>
                <select class="form-control" id="rep-mun-date-type">
                    <option value="implantacao">Data de Implanta√ß√£o</option>
                    <option value="visita">Data da √öltima Visita</option>
                </select>
            </div>
            <div class="form-group">
    <label class="form-label">Data Inicial</label>
    <input type="date" class="form-control" id="rep-mun-start" onchange="validateDateRange('rep-mun')">
</div>
<div class="form-group">
    <label class="form-label">Data Final</label>
    <input type="date" class="form-control" id="rep-mun-end" onchange="validateDateRange('rep-mun')">
</div>
            <div class="form-group">
                <label class="form-label">Filtrar por Status</label>
                <select class="form-control" id="rep-mun-status">
                    <option value="">Todos</option>
                    <option value="Em uso">Em uso</option>
                    <option value="Bloqueado">Bloqueado</option>
                    <option value="Parou de usar">Parou de usar</option>
                    <option value="N√£o Implantado">N√£o Implantado</option>
                </select>
            </div>
        </div>

        <div id="filters-treinamentos" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <div class="form-group">
                <label class="form-label">Considerar Data de:</label>
                <select class="form-control" id="rep-train-date-type">
                    <option value="solicitacao">Data da Solicita√ß√£o</option>
                    <option value="realizacao">Data da Realiza√ß√£o</option>
                </select>
            </div>
            <div class="form-group">
    <label class="form-label">Data Inicial</label>
    <input type="date" class="form-control" id="rep-train-start" onchange="validateDateRange('rep-train')">
</div>
<div class="form-group">
    <label class="form-label">Data Final</label>
    <input type="date" class="form-control" id="rep-train-end" onchange="validateDateRange('rep-train')">
</div>
            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-control" id="rep-train-status">
                    <option value="">Todos</option>
                    <option value="Conclu√≠do">Conclu√≠do</option>
                    <option value="Pendente">Pendente</option>
                    <option value="Cancelado">Cancelado</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Colaborador (Instrutor)</label>
                <select class="form-control" id="rep-train-colab"><option value="">Todos</option></select>
            </div>
            <div class="form-group">
                <label class="form-label">Cargo/Fun√ß√£o</label>
                <select class="form-control" id="rep-train-cargo"><option value="">Todos</option></select>
            </div>
            <div class="form-group">
                <label class="form-label">Munic√≠pio</label>
                <select class="form-control" id="rep-train-mun"><option value="">Todos</option></select>
            </div>
            <div class="form-group">
                <label class="form-label">Profissional (Treinado)</label>
                <input type="text" class="form-control" id="rep-train-prof" placeholder="Nome...">
            </div>
        </div>

        <div id="filters-apresentacoes" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <div class="form-group">
                <label class="form-label">Considerar Data de:</label>
                <select class="form-control" id="rep-pres-date-type">
                    <option value="solicitacao">Data da Solicita√ß√£o</option>
                    <option value="realizacao">Data da Realiza√ß√£o</option>
                </select>
            </div>
           <div class="form-group">
    <label class="form-label">Data Inicial</label>
    <input type="date" class="form-control" id="rep-pres-start" onchange="validateDateRange('rep-pres')">
</div>
<div class="form-group">
    <label class="form-label">Data Final</label>
    <input type="date" class="form-control" id="rep-pres-end" onchange="validateDateRange('rep-pres')">
</div>
            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-control" id="rep-pres-status">
                    <option value="">Todos</option>
                    <option value="Pendente">Pendente</option>
                    <option value="Realizada">Realizada</option>
                    <option value="Cancelada">Cancelada</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Munic√≠pio</label>
                <select class="form-control" id="rep-pres-mun"><option value="">Todos</option></select>
            </div>
            <div class="form-group">
                <label class="form-label">Colaborador Respons√°vel</label>
                <select class="form-control" id="rep-pres-colab"><option value="">Todos</option></select>
            </div>
            <div class="form-group">
                <label class="form-label">Forma de Apresenta√ß√£o</label>
                <select class="form-control" id="rep-pres-form"><option value="">Todas</option></select>
            </div>
        </div>
        
<div id="filters-integracoes" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            
           <div class="form-group">
    <label class="form-label">Vencimento (In√≠cio)</label>
    <input type="date" class="form-control" id="rep-int-start" onchange="validateDateRange('rep-int')">
</div>
<div class="form-group">
    <label class="form-label">Vencimento (Fim)</label>
    <input type="date" class="form-control" id="rep-int-end" onchange="validateDateRange('rep-int')">
</div>

            <div class="form-group">
                <label class="form-label">Status do Certificado</label>
                <select class="form-control" id="rep-int-status">
                    <option value="">Todos</option>
                    <option value="Vencido">Vencido</option>
                    <option value="Alerta">Vence em 30 dias</option>
                    <option value="Em dia">Em dia</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Munic√≠pio</label>
                <select class="form-control" id="rep-int-mun">
                    <option value="">Todos</option>
                    </select>
            </div>

            <div class="form-group">
                <label class="form-label">Possui API</label>
                <select class="form-control" id="rep-int-api">
                    <option value="">Todas</option>
                    </select>
            </div>
        </div>
        <div id="filters-colaboradores" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            
            <div class="form-group">
                <label class="form-label">Situa√ß√£o</label>
                <select class="form-control" id="rep-colab-status">
                    <option value="">Todas</option>
                    <option value="Ativo na Empresa">Ativo na Empresa</option>
                    <option value="Desligado da Empresa">Desligado da Empresa</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Colaborador</label>
                <select class="form-control" id="rep-colab-name">
                    <option value="">Todos</option>
                    </select>
            </div>

           <div class="form-group">
    <label class="form-label">Admiss√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="rep-colab-adm-start" onchange="validateDateRange('rep-colab-adm')">
</div>
<div class="form-group">
    <label class="form-label">Admiss√£o (Fim)</label>
    <input type="date" class="form-control" id="rep-colab-adm-end" onchange="validateDateRange('rep-colab-adm')">
</div>

<div class="form-group">
    <label class="form-label">Desligamento (In√≠cio)</label>
    <input type="date" class="form-control" id="rep-colab-term-start" onchange="validateDateRange('rep-colab-term')">
</div>
<div class="form-group">
    <label class="form-label">Desligamento (Fim)</label>
    <input type="date" class="form-control" id="rep-colab-term-end" onchange="validateDateRange('rep-colab-term')">
</div>
        </div>
          <div id="filters-visitas" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            
            <div class="form-group">
                <label class="form-label">Considerar Data de:</label>
                <select class="form-control" id="rep-vis-date-type">
                    <option value="solicitacao">Data da Solicita√ß√£o</option>
                    <option value="realizacao">Data da Realiza√ß√£o</option>
                </select>
            </div>

            <div class="form-group">
    <label class="form-label">Data Inicial</label>
    <input type="date" class="form-control" id="rep-vis-start" onchange="validateDateRange('rep-vis')">
</div>
<div class="form-group">
    <label class="form-label">Data Final</label>
    <input type="date" class="form-control" id="rep-vis-end" onchange="validateDateRange('rep-vis')">
</div>

            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-control" id="rep-vis-status">
                    <option value="">Todos</option>
                    <option value="Pendente">Pendente</option>
                    <option value="Realizada">Realizada</option>
                    <option value="Cancelada">Cancelada</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Munic√≠pio</label>
                <select class="form-control" id="rep-vis-mun">
                    <option value="">Todos</option>
                    </select>
            </div>

            <div class="form-group">
                <label class="form-label">Solicitante</label>
                <input type="text" class="form-control" id="rep-vis-applicant" placeholder="Nome do solicitante...">
            </div>
        </div>
        <div id="filters-producao" class="report-filter-group" style="display:none; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            
            <div class="form-group">
                <label class="form-label">Considerar Data de:</label>
                <select class="form-control" id="rep-prod-date-type">
                    <option value="liberacao">Data de Libera√ß√£o</option>
                    <option value="envio">Data de Envio</option>
                </select>
            </div>

            <div class="form-group">
    <label class="form-label">Data Inicial</label>
    <input type="date" class="form-control" id="rep-prod-start" onchange="validateDateRange('rep-prod')">
</div>
<div class="form-group">
    <label class="form-label">Data Final</label>
    <input type="date" class="form-control" id="rep-prod-end" onchange="validateDateRange('rep-prod')">
</div>

            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-control" id="rep-prod-status">
                    <option value="">Todos</option>
                    <option value="Enviada">Enviada</option>
                    <option value="Pendente">Pendente</option>
                    <option value="Cancelada">Cancelada</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Frequ√™ncia</label>
                <select class="form-control" id="rep-prod-freq">
                    <option value="">Todas</option>
                    <option value="Di√°rio">Di√°rio</option>
                    <option value="Semanal">Semanal</option>
                    <option value="Quinzenal">Quinzenal</option>
                    <option value="Mensal">Mensal</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Munic√≠pio</label>
                <select class="form-control" id="rep-prod-mun">
                    <option value="">Todos</option>
                    </select>
            </div>

            <div class="form-group">
                <label class="form-label">Profissional</label>
                <input type="text" class="form-control" id="rep-prod-prof" placeholder="Nome do profissional...">
            </div>
        </div>
        <div id="filters-generic" class="report-filter-group" style="display:none; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div class="form-group">
                <label class="form-label">Data Inicial</label>
                <input type="date" class="form-control" id="filter-report-date-from">
            </div>
            <div class="form-group">
                <label class="form-label">Data Final</label>
                <input type="date" class="form-control" id="filter-report-date-to">
            </div>
        </div>
        <div class="form-group" style="margin-top: 20px; margin-bottom: 0; display: flex; gap: 10px;">
            <button class="btn btn--secondary" onclick="clearReportFilters()" style="flex: 1;" title="Limpar todos os campos">
                üßπ Limpar Filtros
            </button>
            <button class="btn" onclick="exportReportToExcel()" style="flex: 1; background-color: #1D6F42; color: white;" title="Baixar planilha .xlsx">
                üìä Exportar Excel
            </button>
            <button class="btn btn--primary" onclick="generateReportPreview()" style="flex: 1;" title="Ver na tela e gerar PDF">
                üìÑ Gerar Visualiza√ß√£o
            </button>
        </div>

    </div>
</div>
        
        <div class="info-box" style="margin-top:20px;">
            <h3>‚ÑπÔ∏è Como funciona</h3>
            <ul>
                <li>Selecione o tipo de relat√≥rio desejado.</li>
                <li>Use os filtros conforme sua prefer√™ncia para obter dados.</li>
                <li>Clique em <strong>Gerar Visualiza√ß√£o</strong> para ver os dados na tela.</li>
                <li>Na janela que abrir, voc√™ poder√° <strong>Imprimir</strong> ou <strong>Salvar em PDF</strong>.</li>
                <li>Clique em <strong>Exportar Excel</strong> para baixar planilha com os dados.</li>
            </ul>
        </div>
    </div>
</section>

        <!-- Aba de Cadastro de Munic√≠pios (Lista Mestra) -->

        <section id="municipalities-list-section" class="tab-content">
    <div class="section-header">
        <h2>Cadastro de Munic√≠pios</h2>
        <button class="btn btn--primary" onclick="showMunicipalityListModal()">+ Novo Munic√≠pio</button>
    </div>

    <div class="filters-section">
        <div class="form-group" style="margin-bottom: 0;">
            <input type="text" class="form-control" id="filter-municipality-list-name" placeholder="Pesquisar munic√≠pio..." oninput="renderMunicipalityList()">
        </div>
    </div>

    <div id="municipalities-list-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>

    <div class="municipalities-table" id="municipalities-list-table">
        </div>
</section>

        <!-- Aba de Formas de Apresenta√ß√£o -->

        <section id="formas-apresentacao-section" class="tab-content">
    <div class="section-header">
        <h2>Formas de Apresenta√ß√£o</h2>
        <button class="btn btn--primary" onclick="showFormaApresentacaoModal()">+ Nova Forma</button>
    </div>
    <div id="formas-apresentacao-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>
    <div class="municipalities-table" id="formas-apresentacao-table"></div>
</section>

        <!-- Aba de Cadastro de Cargo/Fun√ß√£o -->

        <section id="cargos-section" class="tab-content">
    <div class="section-header">
        <h2>Cadastro de Cargo/Fun√ß√£o</h2>
        <button class="btn btn--primary" onclick="showCargoModal()">+ Novo Cargo/Fun√ß√£o</button>
    </div>
    <div id="cargos-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>
    <div class="municipalities-table" id="cargos-table"></div>
</section>

        <!-- Aba de Cadastro de Colaborador -->

       <section id="orientadores-section" class="tab-content">
    <div class="section-header">
        <h2>Cadastro de Colaboradores</h2> <button class="btn btn--primary" onclick="showOrientadorModal()">+ Novo Colaborador</button>
    </div>
    <div id="orientadores-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>
    <div class="municipalities-table" id="orientadores-table"></div>
</section>

        <!-- Aba de Cadastro de M√≥dulos -->

        <section id="modulos-section" class="tab-content">
    <div class="section-header">
        <h2>Cadastro de M√≥dulos</h2>
        <button class="btn btn--primary" onclick="showModuloModal()">+ Novo M√≥dulo</button>
    </div>
    <div id="modulos-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>
    <div class="municipalities-table" id="modulos-table"></div>
</section>

        <!-- Aba de Backup e Restaura√ß√£o -->

        <section id="backup-section" class="tab-content">

            <div class="section-header">

                <h2>Backup e Restaura√ß√£o do Sistema</h2>

            </div>

            <div class="backup-container">

                <!-- Se√ß√£o 1: Fazer Backup -->

                <div class="backup-card">

                    <h3>üì• Fazer Backup Completo do Sistema</h3>

                    <p class="backup-description">Baixa um arquivo com todos os dados: Treinamentos, Munic√≠pios, Cargos, Orientadores, M√≥dulos e Usu√°rios</p>

                    <button class="btn btn--primary" onclick="createBackup()">üì• Fazer Backup Agora</button>

                    <div id="backup-success-message" class="backup-message"></div>

                </div>

                <div class="section-divider"></div>

                <!-- Se√ß√£o 2: Restaurar Backup -->

                <div class="backup-card">

                    <h3>üì§ Restaurar Backup</h3>

                    <p class="backup-description">Selecione um arquivo de backup para restaurar todos os dados do sistema</p>

                    <button class="btn btn--primary" onclick="triggerRestoreBackup()">üì§ Escolher Arquivo de Backup</button>

                    <input type="file" id="backup-file-input" accept=".json" style="display: none;" onchange="handleBackupFileSelect(event)">

                    <div id="restore-message" class="backup-message"></div>

                </div>

                <div class="section-divider"></div>

                <!-- Se√ß√£o 3: Informa√ß√µes do Sistema -->

                <div class="backup-card">

                    <h3>‚ÑπÔ∏è Informa√ß√µes do Sistema</h3>

                    <div class="backup-info">

                        <p><strong>Total de Treinamentos:</strong> <span id="backup-info-trainings">0</span></p>

                        <p><strong>Total de Munic√≠pios:</strong> <span id="backup-info-municipalities">0</span></p>

                        <p><strong>Total de Cargos/Fun√ß√µes:</strong> <span id="backup-info-cargos">0</span></p>

                        <p><strong>Total de Colaboradores:</strong> <span id="backup-info-colaboradores">0</span></p>

                        <p><strong>Total de M√≥dulos:</strong> <span id="backup-info-modules">0</span></p>

                        <p><strong>Total de Usu√°rios:</strong> <span id="backup-info-users">0</span></p>

                    </div>

                </div>

            </div>

        </section>

        <!-- Aba de Gest√£o de Usu√°rios -->

        <section id="usuarios-section" class="tab-content">

            <div class="section-header">

                <h2>Gest√£o de Usu√°rios</h2>

                <button class="btn btn--primary" onclick="showUserModal()">+ Novo Usu√°rio</button>

            </div>

            <h3 class="section-subtitle">Filtros</h3>

            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Nome do Usu√°rio</label>
                        <input type="text" class="form-control" id="filter-user-name" placeholder="Buscar por nome">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Login</label>
                        <input type="text" class="form-control" id="filter-user-login" placeholder="Buscar por login">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-user-status">
                            <option value="">Todos</option>
                            <option value="Ativo">Ativo</option>
                            <option value="Inativo">Inativo</option>
                        </select>
                    </div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearUserFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>
            
            <div id="users-total-display" class="results-count" style="display: none; margin-top: var(--space-16);"></div>

            <div class="municipalities-table" id="users-table">

                <!-- Tabela de usu√°rios ser√° inserida aqui -->

            </div>

            <div class="section-divider"></div>
            <div class="stats-cards">
                <div class="stat-card">

                    <h3 id="total-users">0</h3>

                    <p>Total de Usu√°rios</p>

                </div>

                <div class="stat-card">

                    <h3 id="active-users">0</h3>

                    <p>Usu√°rios Ativos</p>

                </div>

                <div class="stat-card">

                    <h3 id="inactive-users">0</h3>

                    <p>Usu√°rios Inativos</p>

                </div>

            </div>

        </section>

        <!-- Aba de Solicita√ß√µes/Sugest√µes -->

        <section id="solicitacoes-section" class="tab-content">
            <div class="section-header">
                <h2>Solicita√ß√µes/Sugest√µes de Clientes</h2>
                <div style="display: flex; gap: var(--space-8);">
                    <button class="btn btn--primary" onclick="showRequestModal()">+ Nova Solicita√ß√£o</button>
                    <button class="btn btn--primary" onclick="triggerRequestCSVImport()">üì• Importar CSV</button>
                    <input type="file" id="request-csv-import-input" accept=".csv" style="display: none;" onchange="handleRequestCSVImport(event)">
                </div>
            </div>

            <h3 class="section-subtitle">Filtros</h3>
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Munic√≠pio</label>
                        <select class="form-control" id="filter-request-municipality">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-request-status">
                            <option value="">Todos</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Realizado">Realizado</option>
                            <option value="Invi√°vel">Invi√°vel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Usu√°rio</label>
                        <select class="form-control" id="filter-request-user">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Solicitante (Cliente)</label>
                        <input type="text" class="form-control" id="filter-request-solicitante" placeholder="Buscar nome">
                    </div>

                   <div class="form-group">
    <label class="form-label">Solicita√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-request-sol-start" onchange="validateDateRange('request-sol')">
</div>
<div class="form-group">
    <label class="form-label">Solicita√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-request-sol-end" onchange="validateDateRange('request-sol')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-request-real-start" onchange="validateDateRange('request-real')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-request-real-end" onchange="validateDateRange('request-real')">
</div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearRequestFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div id="requests-results-count" class="results-count" style="display: none;"></div>

            <div class="tasks-table" id="requests-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="solicitacoesRowsPerPage" onchange="mudarQtdPorPaginaSolicitacoes(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="solicitacoesPagination">
                    </div>
            </div>
            <div class="actions-bar">
                <button class="btn btn--outline btn--sm" onclick="exportRequestsCSV()">üì• Exportar CSV</button>
                <button class="btn btn--primary btn--sm" onclick="generateRequestsPDF()">üìÑ Gerar PDF</button>
            </div>

            <div class="section-divider"></div>

            <h3 class="section-subtitle">Gr√°ficos e Estat√≠sticas</h3>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-requests">0</h3>
                    <p>Total de Solicita√ß√µes</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-requests">0</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-requests">0</h3>
                    <p>Realizadas</p>
                </div>
                <div class="stat-card">
                    <h3 id="unfeasible-requests">0</h3>
                    <p>Invi√°veis</p>
                </div>
            </div>

           <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="requestStatusChart"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <h4>Solicita√ß√µes por Munic√≠pio</h4>
                        <canvas id="requestMunicipalityChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Aba de Apresenta√ß√µes -->
<section id="apresentacoes-section" class="tab-content">
            <div class="section-header">
                <h2>Apresenta√ß√µes do Software</h2>
                <div style="display: flex; gap: var(--space-8);">
                    <button class="btn btn--primary" onclick="showPresentationModal()">+ Nova Apresenta√ß√£o</button>
                    <button class="btn btn--primary" onclick="triggerPresentationCSVImport()">üì• Importar CSV</button>
                    <input type="file" id="presentation-csv-import-input" accept=".csv" style="display: none;" onchange="handlePresentationCSVImport(event)">
                </div>
            </div>

            <h3 class="section-subtitle">Filtros</h3>
            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Munic√≠pio</label>
                        <select class="form-control" id="filter-presentation-municipality">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-presentation-status">
                            <option value="">Todos</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Realizada">Realizada</option>
                            <option value="Cancelada">Cancelada</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Solicitante</label>
                        <input type="text" class="form-control" id="filter-presentation-requester" placeholder="Buscar solicitante">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Colaborador</label>
                        <select class="form-control" id="filter-presentation-orientador">
                            <option value="">Todos</option>
                        </select>
                    </div>

                    <div class="form-group">
    <label class="form-label">Solicita√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-presentation-sol-start" onchange="validateDateRange('pres-sol')">
</div>
<div class="form-group">
    <label class="form-label">Solicita√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-presentation-sol-end" onchange="validateDateRange('pres-sol')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (In√≠cio)</label>
    <input type="date" class="form-control" id="filter-presentation-real-start" onchange="validateDateRange('pres-real')">
</div>
<div class="form-group">
    <label class="form-label">Realiza√ß√£o (Fim)</label>
    <input type="date" class="form-control" id="filter-presentation-real-end" onchange="validateDateRange('pres-real')">
</div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearPresentationFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div id="presentations-results-count" class="results-count" style="display: none;"></div>

            <div class="tasks-table" id="presentations-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="apresentacoesRowsPerPage" onchange="mudarQtdPorPaginaApres(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="apresentacoesPagination">
                    </div>
            </div>

            <div class="actions-bar">
                <button class="btn btn--outline btn--sm" onclick="exportPresentationsCSV()">üì• Exportar CSV</button>
                <button class="btn btn--primary btn--sm" onclick="generatePresentationsPDF()">üìÑ Gerar PDF</button>
            </div>

            <div class="section-divider"></div>

            <h3 class="section-subtitle">Gr√°ficos e Estat√≠sticas</h3>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-presentations">0</h3>
                    <p>Total de Apresenta√ß√µes</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-presentations">0</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-presentations">0</h3>
                    <p>Realizadas</p>
                </div>
                <div class="stat-card">
                    <h3 id="cancelled-presentations">0</h3>
                    <p>Canceladas</p>
                </div>
            </div>

            <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="presentationStatusChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4>Apresenta√ß√µes por Munic√≠pio</h4>
                        <canvas id="presentationMunicipalityChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h4>Apresenta√ß√µes por Colaborador</h4>
                        <canvas id="presentationOrientadorChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Aba de Tarefas -->

        <section id="tarefas-section" class="tab-content">
            <div class="section-header">
                <h2>Gerenciamento de Treinamentos</h2>
                <div style="display: flex; gap: var(--space-8);">
                    <button class="btn btn--primary" onclick="showTaskModal()">+ Novo Treinamento</button>
                    <button class="btn btn--primary" onclick="triggerTrainingCSVImport()">üì• Importar CSV</button>
                    <input type="file" id="training-csv-import-input" accept=".csv" style="display: none;" onchange="handleTrainingCSVImport(event)">
                </div>
            </div>

            <h3 class="section-subtitle">Filtros</h3>

            <div class="filters-section">
                <div class="filters-grid">
                    <div class="form-group">
                        <label class="form-label">Munic√≠pio</label>
                        <select class="form-control" id="filter-task-municipality">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Colaborador</label>
                        <select class="form-control" id="filter-task-performer">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cargo/Fun√ß√£o</label>
                        <select class="form-control" id="filter-task-position">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <select class="form-control" id="filter-task-status">
                            <option value="">Todos</option>
                            <option value="Conclu√≠do">Conclu√≠dos</option>
                            <option value="Pendente">Pendentes</option>
                            <option value="Cancelado">Cancelados</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Solicitante</label>
                        <input type="text" class="form-control" id="filter-task-requester" placeholder="Buscar solicitante">
                    </div>

                    <div class="form-group">
                    <label class="form-label">Solicita√ß√£o (In√≠cio)</label>
                    <input type="date" class="form-control" id="filter-task-req-start" onchange="validateDateRange('task-req')">
              </div>
                    <div class="form-group">
                    <label class="form-label">Solicita√ß√£o (Fim)</label>
                   <input type="date" class="form-control" id="filter-task-req-end" onchange="validateDateRange('task-req')">
             </div>
                   <div class="form-group">
                         <label class="form-label">Realiza√ß√£o (In√≠cio)</label>
                        <input type="date" class="form-control" id="filter-task-perf-start" onchange="validateDateRange('task-perf')">
                   </div>
                    <div class="form-group">
                        <label class="form-label">Realiza√ß√£o (Fim)</label>
                        <input type="date" class="form-control" id="filter-task-perf-end" onchange="validateDateRange('task-perf')">
                 </div>

                    <div class="form-group" style="display: flex; align-items: flex-end;">
                        <button class="btn btn--secondary btn--full-width" onclick="clearTaskFilters()">Limpar Filtros</button>
                    </div>
                </div>
            </div>

            <div id="tasks-results-count" class="results-count" style="display: none;"></div>

            <div class="tasks-table" id="tasks-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="tarefasRowsPerPage" onchange="mudarQtdPorPaginaTarefas(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="tarefasPagination">
                    </div>
            </div>
            <div class="section-divider"></div>
            <h3 class="section-subtitle">Relat√≥rios e Estat√≠sticas</h3>

            <div class="stats-cards">
                <div class="stat-card">
                    <h3 id="total-tasks">0</h3>
                    <p>Total de Treinamentos</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed-tasks">0</h3>
                    <p>Treinamentos Conclu√≠dos</p>
                </div>
                <div class="stat-card">
                    <h3 id="pending-tasks">0</h3>
                    <p>Treinamentos Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="cancelled-tasks">0</h3>
                    <p>Treinamentos Cancelados</p>
                </div>
            </div>

            <div class="actions-bar">
                <button class="btn btn--outline btn--sm" onclick="exportTasksCSV()">üì• Exportar CSV</button>
                <button class="btn btn--primary btn--sm" onclick="generateTasksPDF()">üìÑ Gerar PDF</button>
            </div>
        </section>

        <!-- Aba de Munic√≠pios -->

        <section id="municipios-section" class="tab-content">

            <div class="section-header">

                <h2>Controle de Munic√≠pios</h2>

                <div style="display: flex; gap: var(--space-8);">

                    <button class="btn btn--primary" onclick="showMunicipalityModal()">+ Novo Munic√≠pio</button>

                    <button class="btn btn--primary" onclick="triggerCSVImport()">üì• Importar CSV</button>

                    <input type="file" id="csv-import-input" accept=".csv" style="display: none;" onchange="handleCSVImport(event)">

                </div>

            </div>

            <h3 class="section-subtitle">Filtros</h3>

            <div class="filters-section">

                <div class="filters-grid">

                    <div class="form-group">

                        <label class="form-label">Nome do Munic√≠pio</label>

                        <select class="form-control" id="filter-municipality-name">

                            <option value="">Todos</option>

                        </select>

                    </div>

                    <div class="form-group">

                        <label class="form-label">Status</label>

                        <select class="form-control" id="filter-municipality-status">

                            <option value="">Todos</option>

                            <option value="Em uso">Em uso</option>

                            <option value="Bloqueado">Bloqueado</option>

                            <option value="Parou de usar">Parou de usar</option>

                            <option value="N√£o Implantado">N√£o Implantado</option>

                        </select>

                    </div>

                    <div class="form-group">
                     <label class="form-label">M√≥dulo</label>
                    <select class="form-control" id="filter-municipality-module" onchange="renderMunicipalities()">
                    <option value="">Todos</option>
                  </select>
                 </div>

                    <div class="form-group">

                        <label class="form-label">Gestor</label>

                        <input type="text" class="form-control" id="filter-municipality-manager" placeholder="Buscar por gestor">

                    </div>

                </div>

                <button class="btn btn--secondary" onclick="clearMunicipalityFilters()">Limpar Filtros</button>

            </div>

            <div id="municipalities-results-count" class="results-count" style="display: none;"></div>

            <div class="municipalities-table" id="municipalities-table">
                </div>

                <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="municipiosRowsPerPage" onchange="mudarQtdPorPagina(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="municipiosPagination">
                    </div>

            </div>

            <div class="section-divider"></div>

            <h3 class="section-subtitle">Relat√≥rios e Gr√°ficos</h3>

            <div class="stats-cards">

                <div class="stat-card">

                    <h3 id="total-municipalities">0</h3>

                    <p>Total de Munic√≠pios</p>

                </div>

                <div class="stat-card">

                    <h3 id="active-municipalities">0</h3>

                    <p>Munic√≠pios Ativos</p>

                </div>

                <div class="stat-card">

                    <h3 id="inactive-municipalities">0</h3>

                    <p>Munic√≠pios Inativos</p>

                </div>

            </div>

            <div class="actions-bar">

                <button class="btn btn--outline btn--sm" onclick="exportMunicipalitiesCSV()">üì• Exportar CSV</button>
                <button class="btn btn--primary btn--sm" onclick="generateMunicipalitiesPDF()">üìÑ Gerar PDF</button>
            </div>
                <div class="charts-section">
                <h4>Dashboard e Gr√°ficos</h4>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h4>Distribui√ß√£o por Status</h4>
                        <canvas id="statusChart"></canvas>
                    </div>

                    <div class="chart-card">
                        <h4>Munic√≠pios por M√≥dulo</h4>
                        <canvas id="modulesChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

       <section id="apis-section" class="tab-content">
    <div class="section-header">
        <h2>Gerenciamento de Integra√ß√µes</h2>
        <button class="btn btn--primary" onclick="showIntegrationModal()">+ Nova Integra√ß√£o</button>
    </div>

    <h3 class="section-subtitle">Filtros</h3>
    <div class="filters-section">
       <div class="filters-grid">
    <div class="form-group">
        <label class="form-label">Munic√≠pio</label>
        <select class="form-control" id="filter-integration-municipality">
            <option value="">Todos</option>
        </select>
    </div>
    
    <div class="form-group">
        <label class="form-label">API Integrada</label>
        <select class="form-control" id="filter-integration-api">
            <option value="">Todas</option>
        </select>
    </div>

    <div class="form-group">
        <label class="form-label">Status Certificado</label>
        <select class="form-control" id="filter-integration-status">
            <option value="">Todos</option>
            <option value="Em dia">Em dia</option>
            <option value="Vencido">Vencido</option>
        </select>
    </div>

    <div class="form-group">
        <label class="form-label">Vencimento (In√≠cio)</label>
        <input type="date" class="form-control" id="filter-integration-start" onchange="validateDateRange('integration')">
    </div>
    
    <div class="form-group">
        <label class="form-label">Vencimento (Fim)</label>
        <input type="date" class="form-control" id="filter-integration-end" onchange="validateDateRange('integration')">
    </div>

    <div class="form-group" style="display: flex; align-items: flex-end;">
        <button class="btn btn--secondary btn--full-width" onclick="clearIntegrationFilters()">Limpar Filtros</button>
    </div>
</div>

    <div id="integrations-results-count" class="results-count" style="display: none;"></div>

    <div class="tasks-table" id="integrations-table"></div>

            <div class="pagination-wrapper">
                <div class="rows-per-page">
                    <label>Itens por p√°gina:</label>
                    <select id="integracoesRowsPerPage" onchange="mudarQtdPorPaginaIntegracoes(this.value)">
                        <option value="15" selected>15</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="pagination-controls" id="integracoesPagination">
                    </div>
            </div>
            <div class="actions-bar">
        <button class="btn btn--outline btn--sm" onclick="exportIntegrationsExcel()">üìä Exportar Excel</button>
    </div>

    <div class="section-divider"></div>

    <div class="charts-section">
        <h4>Estat√≠sticas de Integra√ß√£o</h4>
        <div class="charts-grid">
            <div class="chart-card chart-card--wide">
                <h4>Utiliza√ß√£o por API</h4>
                <div style="height: 300px;">
                    <canvas id="chartApisUsage"></canvas>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="apis-list-section" class="tab-content">
    <div class="section-header">
        <h2>Cadastro de APIs</h2>
        <button class="btn btn--primary" onclick="showApiListModal()">+ Nova API</button>
    </div>
    <div id="apis-list-total" class="results-count" style="display: none; margin-bottom: 16px;"></div>
    <div class="municipalities-table" id="apis-list-table"></div>
</section>

<section id="info-colaboradores-section" class="tab-content">
    <div class="section-header">
        <h2>Gerenciamento de Colaboradores da Sa√∫de</h2>
        <button class="btn btn--primary" onclick="showColabInfoModal()">+ Nova Ficha de Colaborador</button>
    </div>

    <h3 class="section-subtitle">Filtros</h3>
    <div class="filters-section">
        <div class="filters-grid">
            <div class="form-group">
                <label class="form-label">Colaborador</label>
                <select class="form-control" id="filter-colab-info-name">
                    <option value="">Todos</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Situa√ß√£o</label>
                <select class="form-control" id="filter-colab-info-status">
                    <option value="">Todas</option>
                    <option value="Ativo na Empresa">Ativo na Empresa</option>
                    <option value="Desligado da Empresa">Desligado da Empresa</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Admiss√£o (In√≠cio)</label>
                <input type="date" class="form-control" id="filter-colab-info-start" onchange="validateDateRange('colab')">
            </div>
            <div class="form-group">
                <label class="form-label">Admiss√£o (Fim)</label>
                <input type="date" class="form-control" id="filter-colab-info-end" onchange="validateDateRange('colab')">
            </div>
            <div class="form-group" style="display: flex; align-items: flex-end;">
                <button class="btn btn--secondary btn--full-width" onclick="clearColabInfoFilters()">Limpar Filtros</button>
            </div>
        </div>
    </div>

    <div id="colab-info-results-count" class="results-count" style="display: none;"></div>

    <div id="colab-info-results-count" class="results-count" style="display: none;"></div>

    <div id="section-colab-active" style="display:none;">
        <h3 class="colab-section-title title-active">Colaboradores Ativos na Empresa</h3>
        <div class="tasks-table" id="colab-active-table"></div>
    </div>

    <div id="section-colab-terminated" style="display:none;">
        <h3 class="colab-section-title title-terminated">Colaboradores Desligados da Empresa</h3>
        <div class="tasks-table" id="colab-terminated-table"></div>
    </div>
    <div class="actions-bar">
        <button class="btn btn--outline btn--sm" onclick="exportColabInfoExcel()">üìä Exportar Excel</button>
    </div>

    <div class="section-divider"></div>

    <h3 class="section-subtitle">Indicadores de RH</h3>
    <div class="stats-cards">
        <div class="stat-card">
            <h3 id="total-colab-active">0</h3>
            <p>Colaboradores Ativos</p>
        </div>
        <div class="stat-card">
            <h3 id="total-colab-terminated">0</h3>
            <p>Colaboradores Desligados</p>
        </div>
    </div>

    <div class="charts-section">
        <div class="charts-grid">
            <div class="chart-card">
                <h4>Colaboradores por Tempo de Empresa</h4>
                <div style="height: 300px;">
                    <canvas id="chartColabTime"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h4>Contrata√ß√µes por Per√≠odo</h4>
                <div style="height: 300px;">
                    <canvas id="chartColabHires"></canvas>
                </div>
            </div>
        </div>
    </div>
</section>

    <section id="audit-section" class="tab-content">
        <div class="section-header">
    <h2>Auditoria do Sistema</h2>
    <div style="display: flex; gap: 10px;">
        <button class="btn btn--secondary" onclick="clearAuditLogs()">Limpar Logs Antigos</button>
        <button class="btn btn--outline" onclick="exportAuditCSV()">üì• Exportar CSV</button>
        
        <button class="btn btn--primary" onclick="generateAuditPDF()">üñ®Ô∏è Imprimir PDF</button>
    </div>
</div>
        <div class="filters-section">
    <div class="filters-grid">
        <div class="form-group">
            <label class="form-label">A√ß√£o</label>
            <select class="form-control" id="filter-audit-action" onchange="currentPage=1; renderAuditLogs()">
                <option value="">Todas</option>
                <option value="Cria√ß√£o">Cria√ß√£o</option>
                <option value="Edi√ß√£o">Edi√ß√£o</option>
                <option value="Exclus√£o">Exclus√£o</option>
                <option value="Login">Login</option>
                <option value="Restaura√ß√£o">Restaura√ß√£o</option>
            </select>
        </div>

        <div class="form-group">
            <label class="form-label">Usu√°rio</label>
            <input type="text" class="form-control" id="filter-audit-user" placeholder="Quem fez?" 
                   oninput="currentPage=1; renderAuditLogs()">
        </div>

        <div class="form-group">
            <label class="form-label">M√≥dulo/Alvo</label>
            <input type="text" class="form-control" id="filter-audit-target" placeholder="Ex: Munic√≠pio..." 
                   oninput="currentPage=1; renderAuditLogs()">
        </div>

        <div class="form-group">
    <label class="form-label">De (Data)</label>
    <input type="date" class="form-control" id="filter-audit-start" onchange="validateDateRange('audit')">
</div>
<div class="form-group">
    <label class="form-label">At√© (Data)</label>
    <input type="date" class="form-control" id="filter-audit-end" onchange="validateDateRange('audit')">
</div>

        <div class="form-group" style="display: flex; align-items: flex-end;">
            <button class="btn btn--secondary btn--full-width" onclick="clearAuditFilters()">Limpar Filtros</button>
        </div>
    </div>
</div>
        <div class="results-count" id="audit-count" style="margin-bottom: 10px; display:none;"></div>
        
        <div class="municipalities-table" id="audit-table"></div>
    </section>

    </main>

    </div>

    <!-- Modal para Tarefas -->

   <div id="task-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="task-modal-title">Novo Treinamento</h3>
            <button class="close-btn" onclick="closeTaskModal()">&times;</button>
        </div>
        
        <form id="task-form" onsubmit="saveTask(event)">
            <div class="form-grid">
                
                <div class="form-group col-4">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="task-municipality" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Data de Solicita√ß√£o*</label>
                    <input type="date" class="form-control" id="task-date-requested" required>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Solicitante*</label>
                    <input type="text" class="form-control" id="task-requested-by" required>
                </div>

                <div class="form-group col-4">
                    <label class="form-label">Profissional √† treinar/treinado</label>
                    <input type="text" class="form-control" id="task-trained-name">
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Cargo/Fun√ß√£o</label>
                    <select class="form-control" id="task-trained-position">
                        <option value="">Selecione o cargo/fun√ß√£o</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Contato</label>
                    <input type="text" class="form-control" id="task-contact" placeholder="(XX) 9XXXX-XXXX" maxlength="15">
                </div>

                <div class="form-group col-4">
                    <label class="form-label">Colaborador*</label>
                    <select class="form-control" id="task-performed-by" required>
                        <option value="">Selecione o colaborador</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="task-status" required>
                        <option value="Conclu√≠do">Conclu√≠do</option>
                        <option value="Pendente">Pendente</option>
                        <option value="Cancelado">Cancelado</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Data de Realiza√ß√£o</label>
                    <input type="date" class="form-control" id="task-date-performed">
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Observa√ß√µes (m√°x. 200)</label>
                    <textarea class="form-control" id="task-observations" rows="3" maxlength="200"
                        oninput="document.getElementById('task-char-counter').textContent = this.value.length + ' / 200'"></textarea>
                    <div class="char-counter" id="task-char-counter">0 / 200</div>
                </div>

            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeTaskModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Munic√≠pios -->

    <div id="municipality-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="municipality-modal-title">Novo Munic√≠pio</h3>
            <button class="close-btn" onclick="closeMunicipalityModal()">&times;</button>
        </div>

        <form id="municipality-form" onsubmit="saveMunicipality(event)">
            <div class="form-grid">

                <div class="form-group col-4">
                    <label class="form-label">Nome do Munic√≠pio*</label>
                    <select class="form-control" id="municipality-name" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="municipality-status" required onchange="handleMunicipalityStatusChange()">
                        <option value="Em uso">Em uso</option>
                        <option value="Bloqueado">Bloqueado</option>
                        <option value="Parou de usar">Parou de usar</option>
                        <option value="N√£o Implantado">N√£o Implantado</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label" id="implantation-label">Data de Implanta√ß√£o*</label>
                    <input type="date" class="form-control" id="municipality-implantation-date" required>
                </div>

                <div class="form-group col-4">
                    <label class="form-label">Gestor(a) de Sa√∫de Atual*</label>
                    <input type="text" class="form-control" id="municipality-manager" required>
                </div>
                <div class="form-group col-4">
                    <label class="form-label" id="contact-label">Contato do(a) Gestor(a)*</label>
                    <input type="text" class="form-control" id="municipality-contact" placeholder="(XX) 9XXXX-XXXX" maxlength="15" required>
                </div>
                <div class="form-group col-4">
                    <label class="form-label" id="lastvisit-label">Data da √öltima visita</label>
                    <input type="date" class="form-control" id="municipality-last-visit">
                </div>

                <div class="form-group col-4" id="group-date-blocked" style="display:none;">
                    <label class="form-label">Data em que foi Bloqueado*</label>
                    <input type="date" class="form-control" id="municipality-date-blocked">
                </div>
                <div class="form-group col-4" id="group-date-stopped" style="display:none;">
                    <label class="form-label">Data em que Parou de Usar</label>
                    <input type="date" class="form-control" id="municipality-date-stopped">
                </div>

                <div class="form-group col-12" id="modules-group">
                    <label class="form-label" id="modules-label">M√≥dulos em Uso*</label>
                    <div class="checkbox-grid">
                        </div>
                </div>

            </div> <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeMunicipalityModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Alterar Senha -->

    <div id="change-password-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Alterar Senha</h3>
            <button class="close-btn" onclick="closeChangePasswordModal()">&times;</button>
        </div>
        <form id="change-password-form" onsubmit="handleChangePassword(event)">
            <div class="form-grid">
                <div class="form-group col-12">
                    <label class="form-label">Senha Atual*</label>
                    <input type="password" class="form-control" id="current-password" required autocomplete="current-password">
                </div>
                <div class="form-group col-12">
                    <label class="form-label">Nova Senha*</label>
                    <input type="password" class="form-control" id="new-password" required minlength="4" autocomplete="new-password">
                </div>
                <div class="form-group col-12">
                    <label class="form-label">Confirmar Nova Senha*</label>
                    <input type="password" class="form-control" id="confirm-password" required minlength="4" autocomplete="new-password">
                </div>
            </div>
            <div id="change-password-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeChangePasswordModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Alterar Senha</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Gest√£o de Usu√°rios -->

    <div id="user-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="user-modal-title">Novo Usu√°rio</h3>
            <button class="close-btn" onclick="closeUserModal()">&times;</button>
        </div>

        <form id="user-form" onsubmit="saveUser(event)">
            <div class="form-grid">

                <div class="form-group col-4">
                    <label class="form-label">Login*</label>
                    <input type="text" class="form-control" id="user-login" required maxlength="15" style="text-transform: uppercase;">
                </div>
                <div class="form-group col-8">
                    <label class="form-label">Nome Completo*</label>
                    <input type="text" class="form-control" id="user-name" required>
                </div>

                <div class="form-group col-6">
                    <label class="form-label" id="label-user-password">Senha Inicial*</label>
                    <input type="password" class="form-control" id="user-password" autocomplete="new-password">
                </div>
                <div class="form-group col-6">
                    <label class="form-label">E-mail para Recupera√ß√£o*</label> 
                    <input type="email" class="form-control" id="user-email" placeholder="exemplo@email.com" required>
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Permiss√£o*</label>
                    <select class="form-control" id="user-permission" required>
                        <option value="Usu√°rio Normal">Usu√°rio Normal</option>
                        <option value="Administrador">Administrador</option>
                    </select>
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="user-status" required>
                        <option value="Ativo">Ativo</option>
                        <option value="Inativo">Inativo</option>
                    </select>
                </div>
                
            </div>
            <div id="user-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeUserModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Cargo/Fun√ß√£o -->

    <div id="cargo-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="cargo-modal-title">Novo Cargo/Fun√ß√£o</h3>
            <button class="close-btn" onclick="closeCargoModal()">&times;</button>
        </div>
        <form id="cargo-form" onsubmit="saveCargo(event)">
            <div class="form-grid">
                <div class="form-group col-12">
                    <label class="form-label">Nome do Cargo/Fun√ß√£o*</label>
                    <input type="text" class="form-control" id="cargo-name" required>
                </div>
                <div class="form-group col-12">
                    <label class="form-label">Descri√ß√£o</label>
                    <textarea class="form-control" id="cargo-description" rows="3"></textarea>
                </div>
            </div>
            <div id="cargo-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeCargoModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Colaborador -->

    <div id="orientador-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="orientador-modal-title">Novo Colaborador</h3>
            <button class="close-btn" onclick="closeOrientadorModal()">&times;</button>
        </div>
        <form id="orientador-form" onsubmit="saveOrientador(event)">
            <div class="form-grid">
                <div class="form-group col-8">
                    <label class="form-label">Nome do Colaborador*</label>
                    <input type="text" class="form-control" id="orientador-name" required>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Data de Nascimento</label>
                    <input type="date" class="form-control" id="orientador-birthdate">
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="orientador-email" placeholder="nome@email.com">
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Contato</label>
                    <input type="text" class="form-control" id="orientador-contact" placeholder="(XX) 9XXXX-XXXX" maxlength="15">
                </div>
            </div>
            <div id="orientador-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeOrientadorModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Munic√≠pio (Lista Mestra) -->

    <div id="municipality-list-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="municipality-list-modal-title">Novo Munic√≠pio</h3>
            <button class="close-btn" onclick="closeMunicipalityListModal()">&times;</button>
        </div>
        <form id="municipality-list-form" onsubmit="saveMunicipalityList(event)">
            <div class="form-grid">
                <div class="form-group col-9">
                    <label class="form-label">Nome do Munic√≠pio*</label>
                    <input type="text" class="form-control" id="municipality-list-name" required>
                </div>
                <div class="form-group col-3">
                    <label class="form-label">UF</label>
                    <select class="form-control" id="municipality-list-uf">
                        <option value="">UF</option>
                        <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                        <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                        <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                        <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                        <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                        <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                        <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                        <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                        <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                    </select>
                </div>
            </div>
            <div id="municipality-list-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeMunicipalityListModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para M√≥dulo -->

    <div id="modulo-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modulo-modal-title">Novo M√≥dulo</h3>
            <button class="close-btn" onclick="closeModuloModal()">&times;</button>
        </div>
        <form id="modulo-form" onsubmit="saveModulo(event)">
            <div class="form-grid">
                <div class="form-group col-9">
                    <label class="form-label">Nome do M√≥dulo*</label>
                    <input type="text" class="form-control" id="modulo-name" required>
                </div>
                <div class="form-group col-3">
                    <label class="form-label">Abrevia√ß√£o*</label>
                    <input type="text" class="form-control" id="modulo-abbreviation" required maxlength="4" placeholder="Ex: CAD">
                </div>
                <div class="form-group col-12">
                    <label class="form-label">Descri√ß√£o do M√≥dulo* (M√°x 250)</label>
                    <textarea class="form-control" id="modulo-description" rows="3" maxlength="250" required></textarea>
                </div>
            </div>
            <div id="modulo-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeModuloModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal para Solicita√ß√µes/Sugest√µes -->

 <div id="request-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="request-modal-title">Nova Solicita√ß√£o/Sugest√£o</h3>
            <button class="close-btn" onclick="closeRequestModal()">&times;</button>
        </div>

        <form id="request-form" onsubmit="saveRequest(event)">
            <div class="form-grid">

                <div class="form-group col-6">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="request-municipality" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Data da Solicita√ß√£o*</label>
                    <input type="date" class="form-control" id="request-date" required>
                </div>

                <div class="form-group col-6">
                    <label class="form-label">Solicitante*</label>
                    <input type="text" class="form-control" id="request-requester" required>
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Contato do Solicitante*</label>
                    <input type="text" class="form-control" id="request-contact" required placeholder="(XX) 9XXXX-XXXX" maxlength="15">
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Descri√ß√£o da Solicita√ß√£o* (m√°x. 200)</label>
                    <textarea class="form-control" id="request-description" rows="2" required maxlength="200"></textarea>
                    <div class="char-counter" id="request-char-counter">0 / 200</div>
                </div>

                <div class="form-group col-3">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="request-status" required onchange="handleRequestStatusChange()">
                        <option value="Pendente">Pendente</option>
                        <option value="Realizado">Realizado</option>
                        <option value="Invi√°vel">Invi√°vel</option>
                    </select>
                </div>

                <div class="form-group col-3" id="group-request-date-realization" style="display:none;">
                    <label class="form-label">Data de Realiza√ß√£o*</label>
                    <input type="date" class="form-control" id="request-date-realization">
                </div>

                <div class="form-group col-9" id="group-request-justification" style="display:none;">
                    <label class="form-label">Justificativa (Obrigat√≥ria se Invi√°vel)*</label>
                    <textarea class="form-control" id="request-justification" rows="1" maxlength="200"></textarea>
                </div>

            </div> <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeRequestModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para Apresenta√ß√µes -->

    <div id="presentation-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="presentation-modal-title">Nova Apresenta√ß√£o</h3>
            <button class="close-btn" onclick="closePresentationModal()">&times;</button>
        </div>
        <form id="presentation-form" onsubmit="savePresentation(event)">
            <div class="form-grid">
                
                <div class="form-group col-4">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="presentation-municipality" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Data Solicita√ß√£o</label>
                    <input type="date" class="form-control" id="presentation-date-solicitacao">
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Solicitante</label>
                    <input type="text" class="form-control" id="presentation-requester">
                </div>

                <div class="form-group col-12" id="presentation-orientador-group">
                    <label class="form-label" id="presentation-orientador-label">Colaboradores Respons√°veis</label>
                    <div class="checkbox-grid" id="presentation-orientador-checkboxes" style="grid-template-columns: repeat(3, 1fr);">
                        </div>
                </div>

                <div class="form-group col-12" id="presentation-forms-group">
                    <label class="form-label" id="presentation-forms-label">Formas de Apresenta√ß√£o</label>
                    <div class="checkbox-grid" id="presentation-forms-checkboxes" style="grid-template-columns: repeat(3, 1fr);">
                        </div>
                </div>

                <div class="form-group col-6">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="presentation-status" required onchange="handlePresentationStatusChange()">
                        <option value="Pendente">Pendente</option>
                        <option value="Realizada">Realizada</option>
                        <option value="Cancelada">Cancelada</option>
                    </select>
                </div>
                <div class="form-group col-6" id="presentation-date-realizacao-group">
                    <label class="form-label" id="presentation-date-realizacao-label">Data de Realiza√ß√£o</label>
                    <input type="date" class="form-control" id="presentation-date-realizacao">
                </div>

                <div class="form-group col-12">
                    <label class="form-label" id="presentation-description-label">Descri√ß√£o/Detalhes (m√°x. 200)</label>
                    <textarea class="form-control" id="presentation-description" rows="3" maxlength="200" 
                        oninput="document.getElementById('presentation-char-counter').textContent = this.value.length + ' / 200'"></textarea>
                    <div class="char-counter" id="presentation-char-counter">0 / 200</div>
                </div>

            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closePresentationModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para Demandas do Suporte -->

    <div id="demand-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="demand-modal-title">Nova Demanda</h3>
            <button class="close-btn" onclick="closeDemandModal()">&times;</button>
        </div>
        <form id="demand-form" onsubmit="saveDemand(event)">
            <div class="form-grid">
                
                <div class="form-group col-4">
                    <label class="form-label">Data da Solicita√ß√£o*</label>
                    <input type="date" class="form-control" id="demand-date" required>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Prioridade*</label>
                    <select class="form-control" id="demand-priority" required>
                        <option value="">Selecione</option>
                        <option value="Alta">Alta</option>
                        <option value="M√©dia">M√©dia</option>
                        <option value="Baixa">Baixa</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="demand-status" required onchange="handleDemandStatusChange()">
                        <option value="Pendente">Pendente</option>
                        <option value="Realizada">Realizada</option>
                        <option value="Invi√°vel">Invi√°vel</option>
                    </select>
                </div>

                <div class="form-group col-4" id="group-demand-realization-date" style="display:none;">
                    <label class="form-label">Data de Realiza√ß√£o*</label>
                    <input type="date" class="form-control" id="demand-realization-date">
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Descri√ß√£o da Demanda* (m√°x. 250)</label>
                    <textarea class="form-control" id="demand-description" rows="4" required maxlength="250"
                        oninput="document.getElementById('demand-char-counter').textContent = this.value.length + ' / 250'"></textarea>
                    <div class="char-counter" id="demand-char-counter">0 / 250</div>
                </div>

                <div class="form-group col-12" id="group-demand-justification" style="display:none;">
                    <label class="form-label">Justificativa Inviabilidade (Obrigat√≥ria)*</label>
                    <textarea class="form-control" id="demand-justification-reply" rows="2" maxlength="250"></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeDemandModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para Visitas Presenciais -->

    <div id="visit-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="visit-modal-title">Nova Solicita√ß√£o de Visita</h3>
            <button class="close-btn" onclick="closeVisitModal()">&times;</button>
        </div>
        <form id="visit-form" onsubmit="saveVisit(event)">
            <div class="form-grid">
                
                <div class="form-group col-4">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="visit-municipality" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-2">
                    <label class="form-label">Data Solicit.*</label>
                    <input type="date" class="form-control" id="visit-date" required>
                </div>
                <div class="form-group col-6">
                    <label class="form-label">Solicitante*</label>
                    <input type="text" class="form-control" id="visit-applicant" required>
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Motivo da Solicita√ß√£o* (m√°x. 200)</label>
                    <textarea class="form-control" id="visit-reason" rows="2" maxlength="200" required
                        oninput="document.getElementById('visit-reason-counter').textContent = this.value.length + ' / 200'"></textarea>
                    <div class="char-counter" id="visit-reason-counter">0 / 200</div>
                </div>

                <div class="form-group col-3">
                    <label class="form-label">Status*</label>
                    <select class="form-control" id="visit-status" required onchange="handleVisitStatusChange()">
                        <option value="Pendente">Pendente</option>
                        <option value="Realizada">Realizada</option>
                        <option value="Cancelada">Cancelada</option>
                    </select>
                </div>

                <div class="form-group col-3" id="group-visit-date-realization" style="display:none;">
                    <label class="form-label">Data de Realiza√ß√£o*</label>
                    <input type="date" class="form-control" id="visit-date-realization">
                </div>

                <div class="form-group col-9" id="group-visit-justification" style="display:none;">
                    <label class="form-label">Justificativa (Obrigat√≥ria)* (m√°x. 200)</label>
                    <textarea class="form-control" id="visit-justification" rows="1" maxlength="200"
                        oninput="document.getElementById('visit-justification-counter').textContent = this.value.length + ' / 200'"></textarea>
                    <div class="char-counter" id="visit-justification-counter">0 / 200</div>
                </div>

            </div> <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeVisitModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
        
    <!-- Modal para Produ√ß√£o -->
<div id="production-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="production-modal-title">Novo Envio de Produ√ß√£o</h3>
            <button class="close-btn" onclick="closeProductionModal()">&times;</button>
        </div>
        <form id="production-form" onsubmit="saveProduction(event)">
            <div class="form-grid">
                
                <div class="form-group col-4">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="production-municipality" required>
                        <option value="">Selecione o munic√≠pio</option>
                    </select>
                </div>
                <div class="form-group col-5">
                    <label class="form-label">Profissional Informado</label>
                    <input type="text" class="form-control" id="production-professional">
                </div>
                <div class="form-group col-3">
                    <label class="form-label" id="lbl-prod-contact">Contato*</label>
                    <input type="tel" class="form-control" id="production-contact" placeholder="(XX) 9XXXX-XXXX" maxlength="15" required>
                </div>

                <div class="form-group col-3">
                    <label class="form-label">Frequ√™ncia*</label>
                    <select class="form-control" id="production-frequency" required onchange="handleProductionFrequencyChange()">
                        <option value="">Selecione</option>
                        <option value="Di√°rio">Di√°rio</option>
                        <option value="Semanal">Semanal</option>
                        <option value="Quinzenal">Quinzenal</option>
                        <option value="Mensal">Mensal</option>
                    </select>
                </div>
                <div class="form-group col-3">
                    <label class="form-label" id="lbl-prod-competence">Compet√™ncia*</label>
                    <input type="text" class="form-control" id="production-competence" placeholder="MM/AAAA" required>
                </div>
                <div class="form-group col-3" id="production-period-group">
                    <label class="form-label" id="lbl-prod-period">Per√≠odo*</label>
                    <input type="text" class="form-control" id="production-period" placeholder="DD/MM √† DD/MM">
                </div>
                <div class="form-group col-3">
                    <label class="form-label" id="lbl-prod-release">Data Libera√ß√£o*</label>
                    <input type="date" class="form-control" id="production-release-date" required>
                </div>

                <div class="form-group col-2">
                    <label class="form-label" id="lbl-prod-status">Status de Envio</label>
                    <select class="form-control" id="production-status">
                        <option value="Enviada">Enviada</option>
                        <option value="Pendente">Pendente</option>
                        <option value="Cancelada">Cancelada</option>
                    </select>
                </div>
                <div class="form-group col-2">
                    <label class="form-label">Data de Envio</label>
                    <input type="date" class="form-control" id="production-send-date">
                </div>
                <div class="form-group col-8">
                    <label class="form-label">Observa√ß√µes (m√°x. 150)</label>
                    <textarea class="form-control" id="production-observations" rows="1" maxlength="150"
                        oninput="document.getElementById('production-char-counter').textContent = this.value.length + ' / 150'"></textarea>
                    <div class="char-counter" id="production-char-counter">0 / 150</div>
                </div>

            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeProductionModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

<div id="api-list-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="api-list-modal-title">Nova API</h3>
            <button class="close-btn" onclick="closeApiListModal()">&times;</button>
        </div>
        <form id="api-list-form" onsubmit="saveApiList(event)">
            <div class="form-grid">
                <div class="form-group col-12">
                    <label class="form-label">Nome da API*</label>
                    <input type="text" class="form-control" id="api-list-name" required>
                </div>
                <div class="form-group col-12">
                    <label class="form-label">Descri√ß√£o*</label>
                    <textarea class="form-control" id="api-list-description" rows="3" required></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeApiListModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>

         <!-- Modal para Cadastro de API -->
<div id="integration-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="integration-modal-title">Nova Integra√ß√£o</h3>
            <button class="close-btn" onclick="closeIntegrationModal()">&times;</button>
        </div>
        <form id="integration-form" onsubmit="saveIntegration(event)">
            <div class="form-grid">
                
                <div class="form-group col-8">
                    <label class="form-label">Munic√≠pio*</label>
                    <select class="form-control" id="integration-municipality" required>
                        <option value="">Selecione</option>
                    </select>
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Vencimento do Certificado*</label>
                    <input type="date" class="form-control" id="integration-expiration" required>
                </div>

                <div class="form-group col-8">
                    <label class="form-label">Respons√°vel pelo Certificado*</label>
                    <input type="text" class="form-control" id="integration-responsible" required placeholder="Nome do respons√°vel">
                </div>
                <div class="form-group col-4">
                    <label class="form-label">Contato do Respons√°vel</label>
                    <input type="text" class="form-control" id="integration-contact" placeholder="(XX) 9XXXX-XXXX" maxlength="15">
                </div>
                
                <div class="form-group col-12">
                    <label class="form-label">APIs Integradas*</label>
                    <div class="checkbox-grid" id="integration-api-checkboxes" style="grid-template-columns: repeat(4, 1fr); gap: 8px;">
                        </div>
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Observa√ß√£o (m√°x. 250)</label>
                    <textarea class="form-control" id="integration-observation" rows="2" maxlength="250"
                        oninput="document.getElementById('integration-char-counter').textContent = this.value.length + ' / 250'"></textarea>
                    <div class="char-counter" id="integration-char-counter" style="margin-top:2px;">0 / 250</div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeIntegrationModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
            
    <!-- Modal para Forma de Apresenta√ß√£o -->

    <div id="forma-apresentacao-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="forma-apresentacao-modal-title">Nova Forma de Apresenta√ß√£o</h3>
            <button class="close-btn" onclick="closeFormaApresentacaoModal()">&times;</button>
        </div>
        <form id="forma-apresentacao-form" onsubmit="saveFormaApresentacao(event)">
            <div class="form-grid">
                <div class="form-group col-12">
                    <label class="form-label">Nome da Forma de Apresenta√ß√£o*</label>
                    <input type="text" class="form-control" id="forma-apresentacao-name" required>
                </div>
            </div>
            <div id="forma-apresentacao-error" class="error-message"></div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeFormaApresentacaoModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
</div>
    <!-- Modal de Confirma√ß√£o de Restaura√ß√£o -->

    <div id="restore-confirm-modal" class="modal">

        <div class="modal-content">

            <div class="modal-header">

                <h3>‚ö†Ô∏è Confirmar Restaura√ß√£o de Backup</h3>

                <button class="close-btn" onclick="closeRestoreConfirmModal()">&times;</button>

            </div>

            <div style="padding: var(--space-24);">

                <div class="backup-warning">

                    <p><strong>‚ö†Ô∏è ATEN√á√ÉO: Isso ir√° SUBSTITUIR todos os dados atuais do sistema!</strong></p>

                </div>

                <div class="backup-preview">

                    <h4>Preview dos dados que ser√£o restaurados:</h4>

                    <ul id="restore-preview-list">

                    </ul>

                </div>

                <div class="modal-actions">

                    <button type="button" class="btn btn--secondary" onclick="closeRestoreConfirmModal()">Cancelar</button>

                    <button type="button" class="btn btn--danger" onclick="confirmRestore()">‚ö†Ô∏è Restaurar Backup</button>

                </div>

            </div>

        </div>

    </div>
    <!-- Toast de Notifica√ß√£o -->

    <div id="toast" class="toast"></div>

    </div>

    <!-- End Main App -->
    <footer class="app-footer">

        <div class="container">

            <p>&copy; 2025 SIGP Sa√∫de - Gest√£o de Setor. Todos os direitos reservados.</p>

        </div>

    </footer>
 
    <div id="colab-info-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="colab-info-modal-title">Nova Ficha de Colaborador</h3>
            <button class="close-btn" onclick="closeColabInfoModal()">&times;</button>
        </div>
        <form id="colab-info-form" onsubmit="saveColabInfo(event)">
            <div class="form-grid">
                <div class="form-group col-12">
                    <label class="form-label">Colaborador*</label>
                    <select class="form-control" id="colab-info-name" required onchange="handleCollaboratorSelection()">
                        <option value="">Selecione...</option>
                    </select>
                </div>
                
                <div class="form-group col-6">
                    <label class="form-label">Data de Nascimento (Auto)</label>
                    <input type="date" class="form-control" id="colab-info-birth" disabled>
                </div>
                
                <div class="form-group col-6">
                    <label class="form-label">Data de Admiss√£o*</label>
                    <input type="date" class="form-control" id="colab-info-admission" required>
                </div>

                <div class="form-group col-6">
                    <label class="form-label">Situa√ß√£o*</label>
                    <select class="form-control" id="colab-info-status" required onchange="handleColabStatusChange()">
                        <option value="Ativo na Empresa">Ativo na Empresa</option>
                        <option value="Desligado da Empresa">Desligado da Empresa</option>
                    </select>
                </div>

                <div class="form-group col-6" id="group-colab-termination" style="display:none;">
                    <label class="form-label">Data de Desligamento*</label>
                    <input type="date" class="form-control" id="colab-info-termination">
                </div>

                <div class="form-group col-6">
                    <label class="form-label">Data Final √öltimas F√©rias</label>
                    <input type="date" class="form-control" id="colab-info-vacation">
                </div>

                <div class="form-group col-12">
                    <label class="form-label">Observa√ß√µes (m√°x. 250)</label>
                    <textarea class="form-control" id="colab-info-obs" rows="3" maxlength="250"
                        oninput="document.getElementById('colab-info-counter').textContent = this.value.length + ' / 250'"></textarea>
                    <div class="char-counter" id="colab-info-counter">0 / 250</div>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeColabInfoModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary">Salvar</button>
            </div>
        </form>
    </div>
<div id="forgot-password-modal" class="modal">
    <div class="modal-content" style="max-width: 450px;">
        <div class="modal-header">
            <h3>üîê Recuperar Senha</h3>
            <button class="close-btn" onclick="closeForgotPasswordModal()">&times;</button>
        </div>
        
        <form id="forgot-password-form" onsubmit="handleForgotPassword(event)">
            <div style="padding: 24px;">
                <p style="margin-bottom: 15px; color: var(--color-text);">
                    Digite seu <strong>E-mail</strong> ou seu <strong>Nome de Usu√°rio</strong> (Login).
                    Enviaremos um link para voc√™ redefinir sua senha.
                </p>
                
                <div class="form-group">
                    <label class="form-label">E-mail ou Login</label>
                    <input type="text" class="form-control" id="forgot-input" required placeholder="Ex: felipe@email.com ou FELIPE">
                </div>

                <div id="forgot-error" class="error-message" style="display:none; margin-top:10px;"></div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn--secondary" onclick="closeForgotPasswordModal()">Cancelar</button>
                <button type="submit" class="btn btn--primary" id="btn-forgot-send">Enviar Link</button>
            </div>
        </form>
    </div>
</div>
<div id="report-preview-modal" class="modal">
    <div class="modal-content report-preview-content">
        <div class="modal-header">
            <h3 id="report-title">Visualiza√ß√£o de Relat√≥rio</h3>
            <button class="close-btn" onclick="closeReportPreview()">&times;</button>
        </div>

        <<div id="report-preview-body" class="report-document-container">
    </div>
        </div>

        <div class="modal-actions" style="padding:20px; border-top:1px solid #eee;">
            <button class="btn btn--secondary" onclick="closeReportPreview()">Fechar</button>
            <button class="btn btn--primary" onclick="printReport()">üñ®Ô∏è Imprimir / Salvar PDF</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script type="module" src="index.js"></script> 

<div id="modalAvisoInatividade" class="modal-inatividade" style="display: none;">
    <div class="modal-inatividade-content">
        <div class="modal-icon">‚ö†Ô∏è</div>
        <h3>Aten√ß√£o!</h3>
        <p>Sua sess√£o vai expirar em breve por inatividade.</p>
        <button class="btn-confirmar" onclick="confirmarPresenca()">
            Sim, continuar logado
        </button>
    </div>
</div>

</body>
</html>
