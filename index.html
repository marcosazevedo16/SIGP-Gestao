<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIGP Sa√∫de - Gest√£o de Setor</title>
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè•</text></svg>">
</head>
<body>

    <div id="login-screen" class="login-screen active">
        <div class="login-wrapper">
            <div class="login-left">
                <div class="login-branding">
                    <h1 class="login-title">SIGP Sa√∫de</h1>
                    <p class="login-tagline">Gest√£o de Setor</p>
                </div>
            </div>
            <div class="login-right">
                <div class="login-form-container">
                    <h2 class="login-form-title">Acesso ao Sistema</h2>
                    <p class="login-form-subtitle">Digite sua senha para continuar</p>
                    <form id="login-form" onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label class="form-label">Login</label>
                            <input type="text" class="form-control" id="login-username" required placeholder="Digite seu login" autocomplete="username">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Senha</label>
                            <input type="password" class="form-control" id="login-password" required placeholder="Digite sua senha" autocomplete="current-password">
                        </div>
                        <div id="login-error" class="login-error"></div>
                        <button type="submit" class="btn btn--primary btn--full-width login-btn">Entrar no Sistema</button>
                    </form>
                </div>
            </div>
            <div class="login-waves">
                <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
                    <path d="M0,0 C150,80 350,0 600,40 C850,80 1050,20 1200,60 L1200,120 L0,120 Z" fill="rgba(255,255,255,0.1)"/>
                </svg>
            </div>
            <div class="login-waves login-waves-2">
                <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
                    <path d="M0,0 C200,60 400,0 600,30 C800,60 1000,0 1200,40 L1200,120 L0,120 Z" fill="rgba(255,255,255,0.05)"/>
                </svg>
            </div>
        </div>
    </div>

    <div id="main-app" class="main-app">
        
        <header class="app-header">
            <div class="header-content">
                <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                    <span>‚ò∞</span> Menu
                </button>

                <div>
                    <h1>SIGP Sa√∫de</h1>
                    <p class="subtitle">Gest√£o de Setor</p>
                </div>
                
                <div class="header-user-info">
                    <span class="user-welcome">Bem-vindo(a), <strong id="logged-user-name">Administrador</strong></span>
                </div>
                
                <div class="header-actions">
                    <button class="btn btn--outline btn--sm" onclick="navigateToHome()" title="Tela Inicial">üè† In√≠cio</button>
                    <button class="btn btn--outline btn--sm" id="theme-toggle" onclick="toggleTheme()" title="Alternar Tema">üåô Tema</button>
                    
                    <div class="settings-dropdown">
                        <button class="btn btn--outline btn--sm" id="settings-btn" onclick="toggleSettingsMenu()" title="Configura√ß√µes">‚öôÔ∏è Config</button>
                        <div class="settings-menu" id="settings-menu">
                            <button class="settings-menu-item" id="user-management-menu-btn" onclick="navigateToUserManagement()">üë• Gest√£o de Usu√°rios</button>
                            <button class="settings-menu-item" onclick="showChangePasswordModal()">üîí Alterar Senha</button>
                            <div class="settings-divider" id="admin-divider"></div>
                            <button class="settings-menu-item" id="cargo-management-menu-btn" onclick="navigateToCargoManagement()">üíº Cargos/Fun√ß√µes</button>
                            <button class="settings-menu-item" id="orientador-management-menu-btn" onclick="navigateToOrientadorManagement()">üë®‚Äçüè´ Orientadores</button>
                            <button class="settings-menu-item" id="modulo-management-menu-btn" onclick="navigateToModuloManagement()">üì¶ M√≥dulos</button>
                            <button class="settings-menu-item" id="municipality-list-management-menu-btn" onclick="navigateToMunicipalityListManagement()">üèôÔ∏è Lista Mestra Munic√≠pios</button>
                            <button class="settings-menu-item" id="forma-apresentacao-management-menu-btn" onclick="navigateToFormaApresentacaoManagement()">üìã Formas Apres.</button>
                            <button class="settings-menu-item" id="backup-menu-btn" onclick="navigateToBackupManagement()">üíæ Backup e Restaura√ß√£o</button>
                        </div>
                    </div>
                    
                    <button class="btn btn--secondary btn--sm" onclick="handleLogout()">Sair</button>
                </div>
            </div>
        </header>

        <div class="app-layout">
            <aside class="sidebar">
                <nav class="sidebar-nav">
                    <button class="sidebar-btn active" data-tab="dashboard">
                        <span class="sidebar-icon">üìä</span><span>Dashboard</span>
                    </button>
                    <button class="sidebar-btn" data-tab="municipios">
                        <span class="sidebar-icon">üèõ</span><span>Munic√≠pios Clientes</span>
                    </button>
                    <button class="sidebar-btn" data-tab="tarefas">
                        <span class="sidebar-icon">‚úì</span><span>Controle de Treinamentos</span>
                    </button>
                    <button class="sidebar-btn" data-tab="solicitacoes">
                        <span class="sidebar-icon">üí¨</span><span>Solicita√ß√µes/Sugest√µes</span>
                    </button>
                    <button class="sidebar-btn" data-tab="apresentacoes">
                        <span class="sidebar-icon">üìä</span><span>Apresenta√ß√µes do Software</span>
                    </button>
                    <button class="sidebar-btn" data-tab="demandas">
                        <span class="sidebar-icon">üìû</span><span>Demandas do Suporte</span>
                    </button>
                    <button class="sidebar-btn" data-tab="visitas">
                        <span class="sidebar-icon">üöó</span><span>Solicita√ß√µes de Visitas Presenciais</span>
                    </button>
                    <button class="sidebar-btn" data-tab="producao">
                        <span class="sidebar-icon">üì¶</span><span>Controle de Envio de Produ√ß√£o</span>
                    </button>
                    <button class="sidebar-btn" data-tab="versoes">
                        <span class="sidebar-icon">üè∑Ô∏è</span><span>Vers√µes do Sistema</span>
                    </button>
                    <button class="sidebar-btn" data-tab="relatorios">
                        <span class="sidebar-icon">üìà</span><span>Relat√≥rios de Gest√£o</span>
                    </button>
                </nav>
            </aside>

            <main class="main-content">
                
                <section id="dashboard-section" class="tab-content active">
                    <div class="section-header"><h2>Dashboard - Painel de Controle</h2></div>
                    <div class="stats-cards">
                        <div class="stat-card"><h3 id="dashboard-municipalities-in-use">0</h3><p>Total de Munic√≠pios Utilizando SIGP Sa√∫de</p></div>
                        <div class="stat-card"><h3 id="dashboard-trainings-completed">0</h3><p>Total de Treinamentos Realizados</p></div>
                        <div class="stat-card"><h3 id="dashboard-requests-completed">0</h3><p>Total de Solicita√ß√µes Atendidas</p></div>
                        <div class="stat-card"><h3 id="dashboard-presentations-completed">0</h3><p>Total de Apresenta√ß√µes Realizadas</p></div>
                    </div>
                    <div class="chart-card">
                        <h4>Evolu√ß√£o de Implanta√ß√µes por Ano</h4>
                        <div style="height:400px;"><canvas id="implantationsYearChart"></canvas></div>
                    </div>
                </section>

                <section id="municipios-section" class="tab-content">
                    <div class="section-header">
                        <h2>Controle de Munic√≠pios</h2>
                        <div style="display:flex;gap:8px;">
                            <button class="btn btn--primary" onclick="showMunicipalityModal()">+ Novo Munic√≠pio</button>
                            <button class="btn btn--primary" onclick="triggerCSVImport()">üì• Importar CSV</button>
                            <input type="file" id="csv-import-input" accept=".csv" style="display:none;" onchange="handleCSVImport(event)">
                        </div>
                    </div>
                    <div class="filters-section">
                        <div class="filters-grid">
                            <div class="form-group"><label class="form-label">Nome do Munic√≠pio</label><select class="form-control" id="filter-municipality-name"><option value="">Todos</option></select></div>
                            <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-municipality-status"><option value="">Todos</option><option value="Em uso">Em uso</option><option value="Bloqueado">Bloqueado</option><option value="Parou de usar">Parou de usar</option><option value="N√£o Implantado">N√£o Implantado</option></select></div>
                            <div class="form-group"><label class="form-label">M√≥dulo</label><select class="form-control" id="filter-municipality-module"><option value="">Todos</option></select></div>
                            <div class="form-group"><label class="form-label">Gestor</label><input type="text" class="form-control" id="filter-municipality-manager" placeholder="Buscar por gestor"></div>
                        </div>
                        <button class="btn btn--secondary" onclick="clearMunicipalityFilters()">Limpar Filtros</button>
                    </div>
                    <div id="municipalities-results-count" class="results-count"></div>
                    <div class="municipalities-table" id="municipalities-table"></div>
                    
                    <div class="section-divider"></div>
                    <h3 class="section-subtitle">Relat√≥rios e Gr√°ficos</h3>
                    <div class="stats-cards">
                        <div class="stat-card"><h3 id="total-municipalities">0</h3><p>Total de Munic√≠pios</p></div>
                        <div class="stat-card"><h3 id="active-municipalities">0</h3><p>Munic√≠pios Ativos</p></div>
                        <div class="stat-card"><h3 id="inactive-municipalities">0</h3><p>Munic√≠pios Inativos</p></div>
                        <div class="stat-card"><h3 id="avg-days-last-visit">0</h3><p>Dias desde √∫ltima visita (m√©dia)</p></div>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-card"><h4>Distribui√ß√£o por Status</h4><canvas id="statusChart"></canvas></div>
                        <div class="chart-card"><h4>Munic√≠pios por M√≥dulo</h4><canvas id="modulesChart"></canvas></div>
                        <div class="chart-card chart-card--wide"><h4>Implanta√ß√µes ao Longo do Tempo</h4><canvas id="timelineChart"></canvas></div>
                    </div>
                    <div class="actions-bar">
                        <button class="btn btn--outline btn--sm" onclick="exportMunicipalitiesCSV()">üì• Exportar CSV</button>
                        <button class="btn btn--primary btn--sm" onclick="generateMunicipalitiesPDF()">üìÑ Gerar PDF</button>
                    </div>
                </section>

                <section id="tarefas-section" class="tab-content">
                    <div class="section-header"><h2>Gerenciamento de Treinamentos</h2><button class="btn btn--primary" onclick="showTaskModal()">+ Novo Treinamento</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Munic√≠pio</label><select class="form-control" id="filter-task-municipality"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-task-status"><option value="">Todos</option><option value="Conclu√≠do">Conclu√≠do</option><option value="Pendente">Pendente</option><option value="Cancelado">Cancelado</option></select></div>
                        <div class="form-group"><label class="form-label">Solicitante</label><input type="text" class="form-control" id="filter-task-requester"></div>
                        <div class="form-group"><label class="form-label">Orientador</label><select class="form-control" id="filter-task-performer"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Cargo/Fun√ß√£o</label><select class="form-control" id="filter-task-position"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Tipo Data</label><select class="form-control" id="filter-task-date-type"><option value="requested">Solicita√ß√£o</option><option value="performed">Realiza√ß√£o</option></select></div>
                        <div class="form-group"><label class="form-label">In√≠cio</label><input type="date" class="form-control" id="filter-task-date-start"></div>
                        <div class="form-group"><label class="form-label">Fim</label><input type="date" class="form-control" id="filter-task-date-end"></div>
                    </div><button class="btn btn--secondary" onclick="clearTaskFilters()">Limpar Filtros</button></div>
                    <div id="tasks-results-count" class="results-count"></div>
                    <div class="tasks-table" id="tasks-table"></div>
                    <div class="stats-cards">
                        <div class="stat-card"><h3 id="total-tasks">0</h3><p>Total</p></div>
                        <div class="stat-card"><h3 id="completed-tasks">0</h3><p>Conclu√≠dos</p></div>
                        <div class="stat-card"><h3 id="pending-tasks">0</h3><p>Pendentes</p></div>
                        <div class="stat-card"><h3 id="cancelled-tasks">0</h3><p>Cancelados</p></div>
                    </div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportTasksCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generateTasksPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="solicitacoes-section" class="tab-content">
                    <div class="section-header"><h2>Solicita√ß√µes/Sugest√µes de Clientes</h2><button class="btn btn--primary" onclick="showRequestModal()">+ Nova Solicita√ß√£o</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Munic√≠pio</label><select class="form-control" id="filter-request-municipality"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-request-status"><option value="">Todos</option><option value="Pendente">Pendente</option><option value="Realizado">Realizado</option><option value="Invi√°vel">Invi√°vel</option></select></div>
                        <div class="form-group"><label class="form-label">Solicitante</label><input type="text" class="form-control" id="filter-request-solicitante"></div>
                        <div class="form-group"><label class="form-label">Usu√°rio</label><input type="text" class="form-control" id="filter-request-user"></div>
                        <div class="form-group"><label class="form-label">In√≠cio</label><input type="date" class="form-control" id="filter-request-date-start"></div>
                        <div class="form-group"><label class="form-label">Fim</label><input type="date" class="form-control" id="filter-request-date-end"></div>
                    </div><button class="btn btn--secondary" onclick="clearRequestFilters()">Limpar Filtros</button></div>
                    <div id="requests-results-count" class="results-count"></div>
                    <div class="tasks-table" id="requests-table"></div>
                    <div class="stats-cards"><div class="stat-card"><h3 id="total-requests">0</h3><p>Total</p></div><div class="stat-card"><h3 id="pending-requests">0</h3><p>Pendentes</p></div><div class="stat-card"><h3 id="completed-requests">0</h3><p>Realizadas</p></div></div>
                    <div class="charts-grid"><div class="chart-card"><canvas id="requestStatusChart"></canvas></div><div class="chart-card"><canvas id="requestMunicipalityChart"></canvas></div><div class="chart-card"><canvas id="requestRequesterChart"></canvas></div></div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportRequestsCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generateRequestsPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="apresentacoes-section" class="tab-content">
                    <div class="section-header"><h2>Apresenta√ß√µes do Software</h2><button class="btn btn--primary" onclick="showPresentationModal()">+ Nova Apresenta√ß√£o</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Munic√≠pio</label><select class="form-control" id="filter-presentation-municipality"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-presentation-status"><option value="">Todos</option><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option><option value="Cancelada">Cancelada</option></select></div>
                        <div class="form-group"><label class="form-label">Orientador</label><select class="form-control" id="filter-presentation-orientador"><option value="">Todos</option></select></div>
                    </div><button class="btn btn--secondary" onclick="clearPresentationFilters()">Limpar Filtros</button></div>
                    <div id="presentations-results-count" class="results-count"></div>
                    <div class="tasks-table" id="presentations-table"></div>
                    <div class="stats-cards"><div class="stat-card"><h3 id="total-presentations">0</h3><p>Total</p></div></div>
                    <div class="charts-grid"><div class="chart-card"><canvas id="presentationStatusChart"></canvas></div><div class="chart-card"><canvas id="presentationMunicipalityChart"></canvas></div><div class="chart-card"><canvas id="presentationOrientadorChart"></canvas></div></div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportPresentationsCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generatePresentationsPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="demandas-section" class="tab-content">
                    <div class="section-header"><h2>Demandas do Suporte</h2><button class="btn btn--primary" onclick="showDemandModal()">+ Nova Demanda</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-demand-status"><option value="">Todos</option><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option><option value="Invi√°vel">Invi√°vel</option></select></div>
                        <div class="form-group"><label class="form-label">Prioridade</label><select class="form-control" id="filter-demand-priority"><option value="">Todos</option><option value="Alta">Alta</option></select></div>
                    </div><button class="btn btn--secondary" onclick="clearDemandFilters()">Limpar Filtros</button></div>
                    <div id="demands-results-count" class="results-count"></div>
                    <div class="tasks-table" id="demands-table"></div>
                    <div class="charts-grid"><div class="chart-card"><canvas id="demandStatusChart"></canvas></div><div class="chart-card"><canvas id="demandPriorityChart"></canvas></div></div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportDemandsCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generateDemandsPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="visitas-section" class="tab-content">
                    <div class="section-header"><h2>Solicita√ß√µes de Visitas Presenciais</h2><button class="btn btn--primary" onclick="showVisitModal()">+ Nova Solicita√ß√£o</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Munic√≠pio</label><select class="form-control" id="filter-visit-municipality"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-visit-status"><option value="">Todos</option><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option></select></div>
                    </div><button class="btn btn--secondary" onclick="clearVisitFilters()">Limpar Filtros</button></div>
                    <div id="visits-results-count" class="results-count"></div>
                    <div class="tasks-table" id="visits-table"></div>
                    <div class="charts-grid"><div class="chart-card"><canvas id="visitStatusChart"></canvas></div><div class="chart-card"><canvas id="visitMunicipalityChart"></canvas></div></div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportVisitsCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generateVisitsPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="producao-section" class="tab-content">
                    <div class="section-header"><h2>Controle de Envio de Produ√ß√£o</h2><button class="btn btn--primary" onclick="showProductionModal()">+ Novo Envio</button></div>
                    <div class="filters-section"><div class="filters-grid">
                        <div class="form-group"><label class="form-label">Munic√≠pio</label><select class="form-control" id="filter-production-municipality"><option value="">Todos</option></select></div>
                        <div class="form-group"><label class="form-label">Status</label><select class="form-control" id="filter-production-status"><option value="">Todos</option><option value="Enviada">Enviada</option><option value="Pendente">Pendente</option></select></div>
                    </div><button class="btn btn--secondary" onclick="clearProductionFilters()">Limpar Filtros</button></div>
                    <div id="productions-results-count" class="results-count"></div>
                    <div class="tasks-table" id="productions-table"></div>
                    <div class="charts-grid"><div class="chart-card"><canvas id="productionStatusChart"></canvas></div></div>
                    <div class="actions-bar"><button class="btn btn--outline btn--sm" onclick="exportProductionsCSV()">üì• Exportar CSV</button><button class="btn btn--primary btn--sm" onclick="generateProductionsPDF()">üìÑ Gerar PDF</button></div>
                </section>

                <section id="versoes-section" class="tab-content">
                    <div class="section-header"><h2>Hist√≥rico de Vers√µes do Sistema</h2><button class="btn btn--primary" onclick="showVersionModal()">+ Nova Vers√£o</button></div>
                    <div class="tasks-table" id="versions-table"></div>
                </section>

                <section id="relatorios-section" class="tab-content">
                    <div class="section-header"><h2>Relat√≥rios de Gest√£o</h2></div>
                    <div class="empty-state"><p>Funcionalidades em desenvolvimento.</p></div>
                </section>

                <section id="usuarios-section" class="tab-content"><div class="section-header"><h2>Gest√£o de Usu√°rios</h2><button class="btn btn--primary" onclick="showUserModal()">+ Novo Usu√°rio</button></div><div id="users-table"></div></section>
                <section id="cargos-section" class="tab-content"><div class="section-header"><h2>Cadastro de Cargo/Fun√ß√£o</h2><button class="btn btn--primary" onclick="showCargoModal()">+ Novo</button></div><div id="cargos-table"></div></section>
                <section id="orientadores-section" class="tab-content"><div class="section-header"><h2>Cadastro de Orientador</h2><button class="btn btn--primary" onclick="showOrientadorModal()">+ Novo</button></div><div id="orientadores-table"></div></section>
                <section id="modulos-section" class="tab-content"><div class="section-header"><h2>Cadastro de M√≥dulos</h2><button class="btn btn--primary" onclick="showModuloModal()">+ Novo</button></div><div id="modulos-table"></div></section>
                <section id="municipality-list-section" class="tab-content"><div class="section-header"><h2>Cadastro de Munic√≠pios (Lista Mestra)</h2><button class="btn btn--primary" onclick="showMunicipalityListModal()">+ Novo</button></div><div id="municipalities-list-table"></div></section>
                <section id="formas-apresentacao-section" class="tab-content"><div class="section-header"><h2>Formas de Apresenta√ß√£o</h2><button class="btn btn--primary" onclick="showFormaApresentacaoModal()">+ Novo</button></div><div id="formas-apresentacao-table"></div></section>
                
                <section id="backup-section" class="tab-content">
                    <div class="section-header"><h2>Backup e Restaura√ß√£o</h2></div>
                    <div class="backup-container">
                        <div class="backup-card"><h3>üì• Fazer Backup Completo</h3><button class="btn btn--primary" onclick="createBackup()">Baixar</button></div>
                        <div class="backup-card"><h3>üì§ Restaurar Backup</h3><button class="btn btn--primary" onclick="triggerRestoreBackup()">Selecionar Arquivo</button><input type="file" id="backup-file-input" style="display:none" onchange="handleBackupFileSelect(event)"></div>
                        <div class="backup-card"><h3>‚ÑπÔ∏è Informa√ß√µes</h3><p>Munic√≠pios: <span id="backup-info-municipalities">0</span> | Treinamentos: <span id="backup-info-trainings">0</span></p></div>
                    </div>
                </section>
            </main>
        </div>
        <footer class="app-footer"><p>&copy; 2025 SIGP Sa√∫de - Gest√£o de Setor. Todos os direitos reservados.</p></footer>
    </div>

    <div id="municipality-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Munic√≠pio</h3><button class="close-btn" onclick="closeMunicipalityModal()">&times;</button></div><form id="municipality-form" onsubmit="saveMunicipality(event)">
        <div class="form-group"><label class="form-label">Nome*</label><select class="form-control" id="municipality-name" required></select></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="municipality-status" required><option value="Em uso">Em uso</option><option value="Bloqueado">Bloqueado</option><option value="Parou de usar">Parou de usar</option><option value="N√£o Implantado">N√£o Implantado</option></select></div>
        <div class="form-group"><label class="form-label">Gestor*</label><input type="text" class="form-control" id="municipality-manager" required></div>
        <div class="form-group"><label class="form-label">Contato*</label><input type="text" class="form-control" id="municipality-contact" required></div>
        <div class="form-group"><label class="form-label">Implanta√ß√£o*</label><input type="date" class="form-control" id="municipality-implantation-date" required></div>
        <div class="form-group"><label class="form-label">√öltima Visita*</label><input type="date" class="form-control" id="municipality-last-visit" required></div>
        <div class="form-group"><label class="form-label">M√≥dulos*</label><div class="checkbox-grid" id="municipality-modules-container"></div></div>
        <div class="form-group" id="group-date-blocked" style="display:none;"><label class="form-label">Data em que foi Bloqueado*</label><input type="date" class="form-control" id="municipality-date-blocked"></div>
        <div class="form-group" id="group-date-stopped" style="display:none;"><label class="form-label">Data em que Parou de Usar*</label><input type="date" class="form-control" id="municipality-date-stopped"></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeMunicipalityModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="task-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Treinamento</h3><button class="close-btn" onclick="closeTaskModal()">&times;</button></div><form id="task-form" onsubmit="saveTask(event)">
        <div class="form-group"><label class="form-label">Munic√≠pio*</label><select class="form-control" id="task-municipality" required></select></div>
        <div class="form-group"><label class="form-label">Data Solicita√ß√£o*</label><input type="date" class="form-control" id="task-date-requested" required></div>
        <div class="form-group"><label class="form-label">Data Realiza√ß√£o</label><input type="date" class="form-control" id="task-date-performed"></div>
        <div class="form-group"><label class="form-label">Solicitante*</label><input type="text" class="form-control" id="task-requested-by" required></div>
        <div class="form-group"><label class="form-label">Orientador*</label><select class="form-control" id="task-performed-by" required></select></div>
        <div class="form-group"><label class="form-label">Treinado</label><input type="text" class="form-control" id="task-trained-name"></div>
        <div class="form-group"><label class="form-label">Cargo</label><select class="form-control" id="task-trained-position"></select></div>
        <div class="form-group"><label class="form-label">Contato</label><input type="text" class="form-control" id="task-contact"></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="task-status" required><option value="Pendente">Pendente</option><option value="Conclu√≠do">Conclu√≠do</option><option value="Cancelado">Cancelado</option></select></div>
        <div class="form-group"><label class="form-label">Obs</label><textarea class="form-control" id="task-observations"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeTaskModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="request-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Solicita√ß√£o</h3><button class="close-btn" onclick="closeRequestModal()">&times;</button></div><form id="request-form" onsubmit="saveRequest(event)">
        <div class="form-group"><label class="form-label">Munic√≠pio*</label><select class="form-control" id="request-municipality" required></select></div>
        <div class="form-group"><label class="form-label">Data*</label><input type="date" class="form-control" id="request-date" required></div>
        <div class="form-group"><label class="form-label">Solicitante*</label><input type="text" class="form-control" id="request-requester" required></div>
        <div class="form-group"><label class="form-label">Contato*</label><input type="text" class="form-control" id="request-contact"></div>
        <div class="form-group"><label class="form-label">Descri√ß√£o*</label><textarea class="form-control" id="request-description" required></textarea></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="request-status" required><option value="Pendente">Pendente</option><option value="Realizado">Realizado</option><option value="Invi√°vel">Invi√°vel</option></select></div>
        <div class="form-group" id="group-request-date-realization" style="display:none;"><label class="form-label">Data Realiza√ß√£o*</label><input type="date" class="form-control" id="request-date-realization"></div>
        <div class="form-group" id="group-request-justification" style="display:none;"><label class="form-label">Justificativa*</label><textarea class="form-control" id="request-justification"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeRequestModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="presentation-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Apresenta√ß√£o</h3><button class="close-btn" onclick="closePresentationModal()">&times;</button></div><form id="presentation-form" onsubmit="savePresentation(event)">
        <div class="form-group"><label class="form-label">Munic√≠pio*</label><select class="form-control" id="presentation-municipality" required></select></div>
        <div class="form-group"><label class="form-label">Data Sol.*</label><input type="date" class="form-control" id="presentation-date-solicitacao" required></div>
        <div class="form-group"><label class="form-label">Solicitante</label><input type="text" class="form-control" id="presentation-requester"></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="presentation-status" required><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option><option value="Cancelada">Cancelada</option></select></div>
        <div class="form-group"><label class="form-label">Data Realiza√ß√£o</label><input type="date" class="form-control" id="presentation-date-realizacao"></div>
        <div class="form-group"><label class="form-label">Orientadores</label><div class="checkbox-grid" id="presentation-orientador-checkboxes"></div></div>
        <div class="form-group"><label class="form-label">Formas</label><div class="checkbox-grid" id="presentation-forms-checkboxes"></div></div>
        <div class="form-group"><label class="form-label">Obs</label><textarea class="form-control" id="presentation-description"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closePresentationModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="demand-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Demanda</h3><button class="close-btn" onclick="closeDemandModal()">&times;</button></div><form id="demand-form" onsubmit="saveDemand(event)">
        <div class="form-group"><label class="form-label">Data*</label><input type="date" class="form-control" id="demand-date" required></div>
        <div class="form-group"><label class="form-label">Descri√ß√£o*</label><textarea class="form-control" id="demand-description" required></textarea></div>
        <div class="form-group"><label class="form-label">Prioridade*</label><select class="form-control" id="demand-priority" required><option value="Alta">Alta</option><option value="M√©dia">M√©dia</option><option value="Baixa">Baixa</option></select></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="demand-status" required><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option><option value="Invi√°vel">Invi√°vel</option></select></div>
        <div class="form-group" id="group-demand-date-realization" style="display:none;"><label class="form-label">Data Realiza√ß√£o*</label><input type="date" class="form-control" id="demand-date-realization"></div>
        <div class="form-group" id="group-demand-justification" style="display:none;"><label class="form-label">Justificativa</label><textarea class="form-control" id="demand-justification"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeDemandModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="visit-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Visita</h3><button class="close-btn" onclick="closeVisitModal()">&times;</button></div><form id="visit-form" onsubmit="saveVisit(event)">
        <div class="form-group"><label class="form-label">Munic√≠pio*</label><select class="form-control" id="visit-municipality" required></select></div>
        <div class="form-group"><label class="form-label">Data*</label><input type="date" class="form-control" id="visit-date" required></div>
        <div class="form-group"><label class="form-label">Solicitante*</label><input type="text" class="form-control" id="visit-applicant" required></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="visit-status" required><option value="Pendente">Pendente</option><option value="Realizada">Realizada</option><option value="Cancelada">Cancelada</option></select></div>
        <div class="form-group" id="group-visit-date-realization" style="display:none;"><label class="form-label">Data Visita*</label><input type="date" class="form-control" id="visit-date-realization"></div>
        <div class="form-group" id="group-visit-justification" style="display:none;"><label class="form-label">Justificativa*</label><textarea class="form-control" id="visit-justification"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeVisitModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="production-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Produ√ß√£o</h3><button class="close-btn" onclick="closeProductionModal()">&times;</button></div><form id="production-form" onsubmit="saveProduction(event)">
        <div class="form-group"><label class="form-label">Munic√≠pio*</label><select class="form-control" id="production-municipality" required></select></div>
        <div class="form-group"><label class="form-label">Contato*</label><input type="text" class="form-control" id="production-contact" required></div>
        <div class="form-group"><label class="form-label">Freq.*</label><select class="form-control" id="production-frequency" required><option value="Mensal">Mensal</option><option value="Semanal">Semanal</option></select></div>
        <div class="form-group"><label class="form-label">Comp.*</label><input type="text" class="form-control" id="production-competence" required></div>
        <div class="form-group"><label class="form-label">Per√≠odo*</label><input type="text" class="form-control" id="production-period" required></div>
        <div class="form-group"><label class="form-label">Libera√ß√£o*</label><input type="date" class="form-control" id="production-release-date" required></div>
        <div class="form-group"><label class="form-label">Envio</label><input type="date" class="form-control" id="production-send-date"></div>
        <div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="production-status" required><option value="Pendente">Pendente</option><option value="Enviada">Enviada</option></select></div>
        <div class="form-group"><label class="form-label">Obs</label><textarea class="form-control" id="production-observations"></textarea></div>
        <div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeProductionModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div>
    </form></div></div>

    <div id="user-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Usu√°rio</h3><button class="close-btn" onclick="closeUserModal()">&times;</button></div><form id="user-form" onsubmit="saveUser(event)"><div class="form-group"><label class="form-label">Login*</label><input type="text" class="form-control" id="user-login" required autocomplete="off"></div><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="user-name" required></div><div class="form-group"><label class="form-label">Senha*</label><input type="password" class="form-control" id="user-password" autocomplete="new-password"></div><div class="form-group"><label class="form-label">Permiss√£o*</label><select class="form-control" id="user-permission" required><option value="Usu√°rio Normal">Normal</option><option value="Administrador">Admin</option></select></div><div class="form-group"><label class="form-label">Status*</label><select class="form-control" id="user-status" required><option value="Ativo">Ativo</option><option value="Inativo">Inativo</option></select></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeUserModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="cargo-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Cargo</h3><button class="close-btn" onclick="closeCargoModal()">&times;</button></div><form id="cargo-form" onsubmit="saveCargo(event)"><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="cargo-name" required></div><div class="form-group"><label class="form-label">Descri√ß√£o</label><textarea class="form-control" id="cargo-description"></textarea></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeCargoModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="orientador-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Orientador</h3><button class="close-btn" onclick="closeOrientadorModal()">&times;</button></div><form id="orientador-form" onsubmit="saveOrientador(event)"><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="orientador-name" required></div><div class="form-group"><label class="form-label">Contato</label><input type="text" class="form-control" id="orientador-contact"></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-control" id="orientador-email"></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeOrientadorModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="modulo-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>M√≥dulo</h3><button class="close-btn" onclick="closeModuloModal()">&times;</button></div><form id="modulo-form" onsubmit="saveModulo(event)"><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="modulo-name" required></div><div class="form-group"><label class="form-label">Abrevia√ß√£o</label><input type="text" class="form-control" id="modulo-abbreviation"></div><div class="form-group"><label class="form-label">Descri√ß√£o</label><textarea class="form-control" id="modulo-description"></textarea></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeModuloModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="municipality-list-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Lista Mestra</h3><button class="close-btn" onclick="closeMunicipalityListModal()">&times;</button></div><form id="municipality-list-form" onsubmit="saveMunicipalityList(event)"><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="municipality-list-name" required></div><div class="form-group"><label class="form-label">UF</label><input type="text" class="form-control" id="municipality-list-uf"></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeMunicipalityListModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="forma-apresentacao-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Forma Apres.</h3><button class="close-btn" onclick="closeFormaApresentacaoModal()">&times;</button></div><form id="forma-apresentacao-form" onsubmit="saveFormaApresentacao(event)"><div class="form-group"><label class="form-label">Nome*</label><input type="text" class="form-control" id="forma-apresentacao-name" required></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeFormaApresentacaoModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="version-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Vers√£o</h3><button class="close-btn" onclick="closeVersionModal()">&times;</button></div><form id="version-form" onsubmit="saveVersion(event)"><div class="form-group"><label class="form-label">Data*</label><input type="date" class="form-control" id="version-date" required></div><div class="form-group"><label class="form-label">Vers√£o*</label><input type="text" class="form-control" id="version-number" required></div><div class="form-group"><label class="form-label">Tipo</label><select class="form-control" id="version-type"><option value="Feature">Melhoria</option><option value="Bugfix">Corre√ß√£o</option></select></div><div class="form-group"><label class="form-label">M√≥dulo</label><select class="form-control" id="version-module"></select></div><div class="form-group"><label class="form-label">Descri√ß√£o*</label><textarea class="form-control" id="version-description" required></textarea></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeVersionModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    <div id="change-password-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Senha</h3><button class="close-btn" onclick="closeChangePasswordModal()">&times;</button></div><form id="change-password-form" onsubmit="handleChangePassword(event)"><div class="form-group"><label class="form-label">Atual</label><input type="password" class="form-control" id="new-password" required></div><div class="form-group"><label class="form-label">Confirmar</label><input type="password" class="form-control" id="confirm-password" required></div><div class="modal-actions"><button type="button" class="btn btn--secondary" onclick="closeChangePasswordModal()">Cancelar</button><button type="submit" class="btn btn--primary">Salvar</button></div></form></div></div>
    
    <div id="restore-confirm-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3>‚ö†Ô∏è Confirmar Restaura√ß√£o</h3><button class="close-btn" onclick="closeRestoreConfirmModal()">&times;</button></div><div style="padding:20px;"><p>Isso substituir√° todos os dados.</p><ul id="restore-preview-list"></ul><div class="modal-actions"><button class="btn btn--secondary" onclick="closeRestoreConfirmModal()">Cancelar</button><button class="btn btn--danger" onclick="confirmRestore()">Restaurar</button></div></div></div></div>

    <div id="toast" class="toast"></div>
    <script src="script.js?v=27"></script>
</body>
</html>
